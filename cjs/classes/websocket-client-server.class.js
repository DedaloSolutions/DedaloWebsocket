'use strict';const a0_0x716088=a0_0x1414;(function(_0x82ce53,_0x165152){const _0x2db584=a0_0x1414,_0x5ea613=_0x82ce53();while(!![]){try{const _0x55521c=-parseInt(_0x2db584(0x228))/0x1*(parseInt(_0x2db584(0x20f))/0x2)+parseInt(_0x2db584(0x21c))/0x3*(-parseInt(_0x2db584(0x1f9))/0x4)+-parseInt(_0x2db584(0x1e8))/0x5*(parseInt(_0x2db584(0x21f))/0x6)+-parseInt(_0x2db584(0x238))/0x7*(parseInt(_0x2db584(0x208))/0x8)+-parseInt(_0x2db584(0x1fb))/0x9*(-parseInt(_0x2db584(0x1e6))/0xa)+parseInt(_0x2db584(0x20c))/0xb*(-parseInt(_0x2db584(0x1da))/0xc)+parseInt(_0x2db584(0x200))/0xd;if(_0x55521c===_0x165152)break;else _0x5ea613['push'](_0x5ea613['shift']());}catch(_0x57f238){_0x5ea613['push'](_0x5ea613['shift']());}}}(a0_0x19f1,0xcd8bc));function a0_0x1414(_0x2775b9,_0xd1e727){const _0x19f15a=a0_0x19f1();return a0_0x1414=function(_0x1414bf,_0x2a083f){_0x1414bf=_0x1414bf-0x1d9;let _0x3c3407=_0x19f15a[_0x1414bf];return _0x3c3407;},a0_0x1414(_0x2775b9,_0xd1e727);}var __awaiter=this&&this[a0_0x716088(0x214)]||function(_0x2d0184,_0x214b88,_0x1ecae1,_0x2e306a){function _0x561eaa(_0x25dcf6){return _0x25dcf6 instanceof _0x1ecae1?_0x25dcf6:new _0x1ecae1(function(_0x4955f9){_0x4955f9(_0x25dcf6);});}return new(_0x1ecae1||(_0x1ecae1=Promise))(function(_0x21f1a1,_0x5b7196){const _0x2bc19c=a0_0x1414;function _0xd50d8e(_0x358978){const _0x33c1a9=a0_0x1414;try{_0x5a2979(_0x2e306a[_0x33c1a9(0x1e7)](_0x358978));}catch(_0x24ee69){_0x5b7196(_0x24ee69);}}function _0x15758f(_0x1da18f){const _0xe6871f=a0_0x1414;try{_0x5a2979(_0x2e306a[_0xe6871f(0x20b)](_0x1da18f));}catch(_0x3be59d){_0x5b7196(_0x3be59d);}}function _0x5a2979(_0x8032ff){const _0x4a19c4=a0_0x1414;_0x8032ff[_0x4a19c4(0x1e2)]?_0x21f1a1(_0x8032ff[_0x4a19c4(0x236)]):_0x561eaa(_0x8032ff[_0x4a19c4(0x236)])[_0x4a19c4(0x1de)](_0xd50d8e,_0x15758f);}_0x5a2979((_0x2e306a=_0x2e306a[_0x2bc19c(0x230)](_0x2d0184,_0x214b88||[]))['next']());});},__importDefault=this&&this[a0_0x716088(0x1fa)]||function(_0x5657a7){return _0x5657a7&&_0x5657a7['__esModule']?_0x5657a7:{'default':_0x5657a7};};Object[a0_0x716088(0x222)](exports,a0_0x716088(0x232),{'value':!![]});const crypto_1=__importDefault(require(a0_0x716088(0x218)));class WebsocketClientServer{constructor(_0x85703){const _0x1bffd7=a0_0x716088;this[_0x1bffd7(0x21a)]=_0x85703,this[_0x1bffd7(0x224)]=_0x1bffd7(0x1ea),this[_0x1bffd7(0x231)]=0x5*0x3e8,this[_0x1bffd7(0x1e0)]=0x2*0x3e8,this[_0x1bffd7(0x237)]={},this['requestId']=0x1,this['pendingRequests']={},this['locals']={},this['handlers']={},this[_0x1bffd7(0x21a)]['on']('data',_0x3a58c6=>this['handle'](_0x3a58c6)),this[_0x1bffd7(0x21a)]['on']('error',_0x49a097=>this['raise'](_0x1bffd7(0x1e3),_0x49a097)),this[_0x1bffd7(0x21a)]['on']('close',()=>{}),this['checkHeartbeat']();const _0xa49578=this[_0x1bffd7(0x210)]({'pingInterval':this['pingInterval']});this[_0x1bffd7(0x1fc)]('binary',_0xa49578);}[a0_0x716088(0x1db)](){return __awaiter(this,arguments,void 0x0,function*(_0x39fe45=0x3e8,_0x56202c='',_0x3e17e5=0x1388){return new Promise((_0x1468d7,_0x4548c1)=>{const _0x5a4222=a0_0x1414,_0x2944d2=Buffer[_0x5a4222(0x21e)](_0x56202c,_0x5a4222(0x20a)),_0x4b2b05=Buffer['alloc'](0x2+_0x2944d2['length']);_0x4b2b05[_0x5a4222(0x209)](_0x39fe45,0x0),_0x2944d2[_0x5a4222(0x1f3)](_0x4b2b05,0x2);const _0x18c66b=_0x4b2b05['length'],_0xc9fa91=_0x18c66b<0x7e?_0x18c66b:_0x18c66b<0x10000?0x7e:0x7f,_0x42c8a1=_0xc9fa91===0x7e?Buffer[_0x5a4222(0x21e)]([0x88,0x7e,_0x18c66b>>0x8&0xff,_0x18c66b&0xff]):_0xc9fa91===0x7f?Buffer['from']([0x88,0x7f,0x0,0x0,0x0,0x0,0x0,0x0,_0x18c66b>>0x8&0xff,_0x18c66b&0xff]):Buffer['from']([0x88,_0x18c66b]),_0x546251=Buffer[_0x5a4222(0x201)]([_0x42c8a1,_0x4b2b05]);this[_0x5a4222(0x21a)]['write'](_0x546251),this['status']=_0x5a4222(0x1f5);if(_0x3e17e5===null)this[_0x5a4222(0x224)]=_0x5a4222(0x221),this['socket'][_0x5a4222(0x20e)](),this[_0x5a4222(0x1f4)](_0x5a4222(0x213),{'code':_0x39fe45,'reason':_0x56202c}),_0x1468d7();else{let _0x442c70=!![];this[_0x5a4222(0x21a)]['once'](_0x5a4222(0x220),_0x454296=>{const _0x89e115=_0x5a4222;if(!_0x442c70)return;_0x454296[0x0]===0x88?(this['status']='closed',this[_0x89e115(0x21a)][_0x89e115(0x20e)](),this[_0x89e115(0x1f4)](_0x89e115(0x213),{'code':_0x39fe45,'reason':_0x56202c}),_0x1468d7()):_0x4548c1(new Error(_0x89e115(0x1e1)));}),setTimeout(()=>{const _0xf0c006=_0x5a4222;_0x442c70=![],_0x4548c1(new Error(_0xf0c006(0x206))),this[_0xf0c006(0x21a)][_0xf0c006(0x20e)]();},_0x3e17e5);}});});}['send'](_0x2d3016,_0x87734a){const _0x14246a=a0_0x716088;let _0x3d3c7b,_0x37c483;switch(_0x2d3016){case'text':_0x3d3c7b=Buffer[_0x14246a(0x21e)](_0x87734a,_0x14246a(0x20a)),_0x37c483=0x1;break;case _0x14246a(0x1e9):_0x3d3c7b=_0x87734a,_0x37c483=0x2;break;case'ping':_0x3d3c7b=_0x87734a,_0x37c483=0x9;break;case'pong':_0x3d3c7b=_0x87734a,_0x37c483=0xa;break;}const _0x388f2f=[];if(_0x3d3c7b[_0x14246a(0x203)]<0x7e)_0x388f2f[_0x14246a(0x1fe)](_0x3d3c7b[_0x14246a(0x203)]);else{if(_0x3d3c7b[_0x14246a(0x203)]<0x10000)_0x388f2f['push'](0x7e,_0x3d3c7b[_0x14246a(0x203)]>>0x8&0xff,_0x3d3c7b[_0x14246a(0x203)]&0xff);else{_0x388f2f[_0x14246a(0x1fe)](0x7f);for(let _0x53c0eb=0x7;_0x53c0eb>=0x0;_0x53c0eb--)_0x388f2f[_0x14246a(0x1fe)](_0x3d3c7b[_0x14246a(0x203)]>>_0x53c0eb*0x8&0xff);}}const _0x994703=Buffer[_0x14246a(0x201)]([Buffer[_0x14246a(0x21e)]([0x80|_0x37c483,..._0x388f2f]),_0x3d3c7b]);this[_0x14246a(0x21a)][_0x14246a(0x1fd)](_0x994703);}[a0_0x716088(0x212)](_0x2c087f,_0x4cc71d,_0x504f2f,_0x212dcf=0x32*0x3e8){const _0x21c7e1=a0_0x716088;if(this[_0x21c7e1(0x21a)]==undefined||this['status']!==_0x21c7e1(0x1f6))throw new Error(_0x21c7e1(0x207));if(['handshake',_0x21c7e1(0x1f6),_0x21c7e1(0x1e3),_0x21c7e1(0x213)]['includes'](_0x2c087f))throw new Error('Cannot\x20emit\x20a\x20class\x20internal\x20event\x20as\x20handskake,\x20open,\x20error\x20or\x20close');const _0x33490f=_0x504f2f==undefined?0x0:this['requestId'],_0xa10625=Buffer[_0x21c7e1(0x21e)](_0x2c087f,_0x21c7e1(0x20a));if(_0xa10625[_0x21c7e1(0x203)]>0xff)throw new Error(_0x21c7e1(0x1ec));if(_0x504f2f!=undefined){this[_0x21c7e1(0x22d)]=(this[_0x21c7e1(0x22d)]+0x1)%0x80||0x1;const _0x354934=setTimeout(()=>{const _0x37b19c=_0x21c7e1;delete this[_0x37b19c(0x1f8)][_0x33490f],_0x504f2f(new Error(_0x37b19c(0x233)));},_0x212dcf);this[_0x21c7e1(0x1f8)][_0x33490f]=_0x179936=>{if(!(_0x179936 instanceof Error))clearTimeout(_0x354934);_0x504f2f(_0x179936);};}const _0x21d7d7=Buffer[_0x21c7e1(0x201)]([Buffer['from']([_0x33490f|0x80,_0xa10625['length']]),_0xa10625,this[_0x21c7e1(0x210)](_0x4cc71d)]);this[_0x21c7e1(0x1fc)](_0x21c7e1(0x1e9),_0x21d7d7);}[a0_0x716088(0x1e5)](_0x28f27d){const _0x482362=a0_0x716088;var _0x3ad535;const _0x5882c0=_0x28f27d[0x0],_0x1d1249=(_0x5882c0&0x80)!==0x0,_0x2d60f5=_0x5882c0&0xf,_0x313eee=_0x28f27d[0x1],_0x6043de=(_0x313eee&0x80)!==0x0;let _0x222716=_0x313eee&0x7f,_0x1c6874=0x2;if(_0x222716===0x7e)_0x222716=_0x28f27d[_0x482362(0x22f)](_0x1c6874),_0x1c6874+=0x2;else _0x222716===0x7f&&(_0x222716=Number(_0x28f27d[_0x482362(0x1e4)](_0x1c6874)),_0x1c6874+=0x8);const _0x2bd754=_0x6043de?_0x28f27d[_0x482362(0x219)](_0x1c6874,_0x1c6874+0x4):Buffer[_0x482362(0x205)](0x0);if(_0x6043de)_0x1c6874+=0x4;let _0x2f7696=_0x28f27d[_0x482362(0x219)](_0x1c6874,_0x1c6874+_0x222716);if(_0x6043de){const _0x481bb7=Buffer[_0x482362(0x205)](_0x2f7696['length']);for(let _0x33ec9e=0x0;_0x33ec9e<_0x2f7696[_0x482362(0x203)];_0x33ec9e++)_0x481bb7[_0x33ec9e]=_0x2f7696[_0x33ec9e]^_0x2bd754[_0x33ec9e%0x4];_0x2f7696=_0x481bb7;}switch(_0x2d60f5){case 0x1:this[_0x482362(0x1f4)](_0x482362(0x1e3),new Error(_0x482362(0x1f7)+_0x2f7696[_0x482362(0x204)](_0x482362(0x20a))));break;case 0x2:{if(this[_0x482362(0x224)]==='handshake'){const _0x3e519b=this[_0x482362(0x1df)](_0x2f7696);for(const _0x2d4f5e of this[_0x482362(0x21d)][_0x482362(0x1ea)]||[]){const _0x40baf7=_0x2d4f5e[_0x482362(0x1ed)](undefined,_0x3e519b);if(_0x40baf7===![]){this[_0x482362(0x1db)](0x3e8,'',null);return;}}this[_0x482362(0x224)]=_0x482362(0x1f6),this[_0x482362(0x1fc)](_0x482362(0x1e9),Buffer[_0x482362(0x205)](0x0));return;}const _0xa770e4=_0x2f7696[_0x482362(0x22e)](0x0),_0x6e4f6e=_0xa770e4&0x7f,_0x291c2c=(_0xa770e4&0x80)!==0x0;if(_0x291c2c){const _0x26fe02=_0x2f7696['readUInt8'](0x1),_0x109825=_0x2f7696[_0x482362(0x219)](0x2,0x2+_0x26fe02)[_0x482362(0x204)](_0x482362(0x20a));if([_0x482362(0x1ea),_0x482362(0x1f6),_0x482362(0x1e3),_0x482362(0x213)]['includes'](_0x109825)){this[_0x482362(0x1f4)](_0x482362(0x1e3),new Error(_0x482362(0x1f1)+_0x109825+';\x20This\x20is\x20non-standard:\x20someone\x20is\x20trying\x20to\x20hack\x20the\x20protocol?'));return;}const _0x4f5bdc=this[_0x482362(0x1df)](_0x2f7696[_0x482362(0x219)](0x2+_0x26fe02)),_0x850d0=(_0x3ad535=this[_0x482362(0x21d)][_0x109825])!==null&&_0x3ad535!==void 0x0?_0x3ad535:[];let _0x2cb33e=![];for(const _0x1f037a of _0x850d0){const _0x864c68=_0x1f037a['call'](undefined,_0x4f5bdc);if(!_0x2cb33e&&_0x864c68!==undefined&&_0x6e4f6e!==0x0){_0x2cb33e=!![];const _0x4ae8d8=Buffer['concat']([Buffer[_0x482362(0x21e)]([_0x6e4f6e&0x7f]),this[_0x482362(0x210)](_0x864c68)]);this[_0x482362(0x1fc)](_0x482362(0x1e9),_0x4ae8d8);}}if(!_0x2cb33e&&_0x6e4f6e!==0x0)this[_0x482362(0x1f4)]('error',new Error(_0x482362(0x1f2)+_0x109825+_0x482362(0x22c)));return;}const _0x2b62ef=this[_0x482362(0x1f8)][_0x6e4f6e];if(_0x2b62ef==undefined){this[_0x482362(0x1f4)](_0x482362(0x1e3),new Error(_0x482362(0x234)+_0x6e4f6e+_0x482362(0x216)));return;}const _0x5d59c5=this[_0x482362(0x1df)](_0x2f7696[_0x482362(0x219)](0x1));_0x2b62ef[_0x482362(0x1ed)](undefined,_0x5d59c5);break;}case 0x9:this[_0x482362(0x1fc)](_0x482362(0x21b),_0x2f7696);break;case 0xa:const _0x356ab2=_0x2f7696['toString']('utf-8'),_0x3d45d5=this['pingRequests'][_0x356ab2];if(_0x3d45d5==undefined){this[_0x482362(0x1f4)](_0x482362(0x1e3),new Error(_0x482362(0x1eb)));return;}_0x3d45d5();break;case 0x8:if(this['status']===_0x482362(0x1f5))return;let _0x317cb2=0x3e8,_0x53f8e6='';_0x2f7696[_0x482362(0x203)]>=0x2&&(_0x317cb2=_0x2f7696[_0x482362(0x22f)](0x0),_0x53f8e6=_0x2f7696[_0x482362(0x219)](0x2)[_0x482362(0x204)](_0x482362(0x20a)));this['disconnect'](_0x317cb2,_0x53f8e6,null);break;default:this[_0x482362(0x1f4)](_0x482362(0x1e3),new Error(_0x482362(0x225)+_0x2d60f5));}}[a0_0x716088(0x210)](_0x42c7d0){const _0x2edf37=a0_0x716088;return Buffer[_0x2edf37(0x21e)](JSON[_0x2edf37(0x22b)](_0x42c7d0),_0x2edf37(0x20a));}['decode'](_0x15ae0c){const _0x27bdd3=a0_0x716088;return JSON[_0x27bdd3(0x20d)](_0x15ae0c[_0x27bdd3(0x204)](_0x27bdd3(0x20a)));}['checkHeartbeat'](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise((_0x3ba195,_0x396b20)=>{const _0x2be933=a0_0x1414,_0x40df5c=crypto_1[_0x2be933(0x223)][_0x2be933(0x217)](),_0x5144d0=setTimeout(()=>{const _0x338870=_0x2be933;delete this[_0x338870(0x237)][_0x40df5c],this['disconnect'](0x3e8,'',null),_0x3ba195(![]);},this[_0x2be933(0x1e0)]);this[_0x2be933(0x237)][_0x40df5c]=()=>{const _0x508c3e=_0x2be933;delete this[_0x508c3e(0x237)][_0x40df5c],clearTimeout(_0x5144d0),_0x3ba195(!![]),setTimeout(()=>{const _0x5809e7=_0x508c3e;if(this[_0x5809e7(0x224)]!==_0x5809e7(0x1f6))return;this[_0x5809e7(0x227)]();},this[_0x508c3e(0x231)]);},this[_0x2be933(0x1fc)](_0x2be933(0x22a),Buffer[_0x2be933(0x21e)](_0x40df5c));});});}['on'](_0x3b3e84,_0xb0bba5){const _0x4d0136=a0_0x716088;if(this[_0x4d0136(0x21d)][_0x3b3e84]==undefined)this[_0x4d0136(0x21d)][_0x3b3e84]=[];this[_0x4d0136(0x21d)][_0x3b3e84]['push'](_0xb0bba5);}['off'](_0x5e9f1a,_0x4a58f8){const _0x52c4d2=a0_0x716088;if(_0x4a58f8==undefined){this[_0x52c4d2(0x21d)][_0x5e9f1a]=[];return;}const _0xdc368d=this[_0x52c4d2(0x21d)][_0x5e9f1a],_0x3a9d98=(_0xdc368d!==null&&_0xdc368d!==void 0x0?_0xdc368d:[])[_0x52c4d2(0x211)](_0x14f074=>_0x14f074===_0x4a58f8);if(_0x3a9d98===-0x1)throw new Error(_0x52c4d2(0x229)+_0x5e9f1a+_0x52c4d2(0x202));_0xdc368d['splice'](_0x3a9d98,0x1);}[a0_0x716088(0x1f4)](_0x5de53d,_0x111fd4){const _0xe61f92=a0_0x716088;var _0x53ed30;const _0x4f825f=(_0x53ed30=this[_0xe61f92(0x21d)][_0x5de53d])!==null&&_0x53ed30!==void 0x0?_0x53ed30:[];for(const _0x2439fa of _0x4f825f){_0x2439fa(_0x111fd4);}}static[a0_0x716088(0x1ef)](_0x3a047a,_0x54f369){const _0x23426c=a0_0x716088,_0x4e5a5a=_0x3a047a['headers'][_0x23426c(0x226)];if(_0x4e5a5a==undefined)return _0x54f369[_0x23426c(0x1dd)](),null;const _0x27ef57=crypto_1[_0x23426c(0x223)][_0x23426c(0x1ff)]('sha1');_0x27ef57[_0x23426c(0x1ee)](_0x4e5a5a+_0x23426c(0x235));const _0x3b477f=_0x27ef57['digest'](_0x23426c(0x1d9)),_0x3ae420=[_0x23426c(0x1dc),'Upgrade:\x20websocket',_0x23426c(0x215),'Sec-WebSocket-Accept:\x20'+_0x3b477f];return _0x54f369[_0x23426c(0x1fd)](_0x3ae420[_0x23426c(0x1f0)]('\x0d\x0a')+'\x0d\x0a\x0d\x0a'),new WebsocketClientServer(_0x54f369);}}function a0_0x19f1(){const _0x26f5ab=['84GekIxO','data','closed','defineProperty','default','status','Received\x20message\x20with\x20unsupported\x20opcode:\x20','sec-websocket-key','checkHeartbeat','1HbDutT','Attempted\x20to\x20remove\x20an\x20handler\x20for\x20','ping','stringify','\x20but\x20no\x20handler\x20return\x20a\x20result','requestId','readUInt8','readUInt16BE','apply','pingInterval','__esModule','Timeout','Received\x20a\x20response\x20for\x20the\x20id\x20','258EAFA5-E914-47DA-95CA-C5AB0DC85B11','value','pingRequests','224CbNOqy','base64','5360748trpNby','disconnect','HTTP/1.1\x20101\x20Switching\x20Protocols','destroy','then','decode','pingTimeout','Failed\x20to\x20receive\x20valid\x20close\x20frame\x20from\x20server.','done','error','readBigUInt64BE','handle','5859370vAhtir','next','287675lGZsOL','binary','handshake','Received\x20a\x20pong,\x20but\x20it\x20doesn\x27t\x20match\x20any\x20ping','Event\x20name\x20too\x20long\x20(max\x20255\x20bytes)','call','update','fromUpgradeRequest','join','Received\x20a\x20request\x20with\x20eventName\x20','Received\x20a\x20request\x20with\x20callback\x20for\x20the\x20event\x20','copy','raise','closing','open','Received\x20non-standard\x20text\x20message:\x20','pendingRequests','116324ShwjcK','__importDefault','9LKMHuP','send','write','push','createHash','40465022TwriEm','concat','\x20event\x20type\x20but\x20it\x20wasn\x27t\x20found','length','toString','alloc','Timeout\x20waiting\x20for\x20close\x20frame\x20acknowledgment.','The\x20websocket\x20is\x20not\x20connected','294248Djlsvo','writeUInt16BE','utf-8','throw','11CREmZC','parse','end','796846UEedTq','encode','findIndex','emit','close','__awaiter','Connection:\x20Upgrade','\x20but\x20no\x20pending\x20request\x20was\x20found','randomUUID','crypto','slice','socket','pong','3YVTRQe','handlers','from'];a0_0x19f1=function(){return _0x26f5ab;};return a0_0x19f1();}exports['default']=WebsocketClientServer;