'use strict';const a2_0x28ad17=a2_0xbccd;(function(_0x26adf2,_0x33cd15){const _0x354674=a2_0xbccd,_0x46936a=_0x26adf2();while(!![]){try{const _0x3c4b1b=parseInt(_0x354674(0x17e))/0x1+-parseInt(_0x354674(0x162))/0x2+-parseInt(_0x354674(0x15d))/0x3*(parseInt(_0x354674(0x15c))/0x4)+parseInt(_0x354674(0x18f))/0x5*(parseInt(_0x354674(0x140))/0x6)+-parseInt(_0x354674(0x167))/0x7+-parseInt(_0x354674(0x163))/0x8+-parseInt(_0x354674(0x178))/0x9;if(_0x3c4b1b===_0x33cd15)break;else _0x46936a['push'](_0x46936a['shift']());}catch(_0x704a04){_0x46936a['push'](_0x46936a['shift']());}}}(a2_0x56f6,0x5c9f7));var __awaiter=this&&this[a2_0x28ad17(0x180)]||function(_0x324639,_0x48eab8,_0x9dc213,_0x222855){function _0x59894e(_0x5ee0f2){return _0x5ee0f2 instanceof _0x9dc213?_0x5ee0f2:new _0x9dc213(function(_0x46b3f0){_0x46b3f0(_0x5ee0f2);});}return new(_0x9dc213||(_0x9dc213=Promise))(function(_0x151434,_0xdf3145){const _0x402181=a2_0xbccd;function _0x3a6a55(_0xe24d5f){const _0x28a5a2=a2_0xbccd;try{_0x17f161(_0x222855[_0x28a5a2(0x170)](_0xe24d5f));}catch(_0x41a53a){_0xdf3145(_0x41a53a);}}function _0x46e602(_0x123c04){try{_0x17f161(_0x222855['throw'](_0x123c04));}catch(_0x208fde){_0xdf3145(_0x208fde);}}function _0x17f161(_0x16c828){const _0xe8d97d=a2_0xbccd;_0x16c828['done']?_0x151434(_0x16c828[_0xe8d97d(0x176)]):_0x59894e(_0x16c828[_0xe8d97d(0x176)])[_0xe8d97d(0x16e)](_0x3a6a55,_0x46e602);}_0x17f161((_0x222855=_0x222855[_0x402181(0x16b)](_0x324639,_0x48eab8||[]))[_0x402181(0x170)]());});},__importDefault=this&&this[a2_0x28ad17(0x13d)]||function(_0x4a5b74){const _0x19db73=a2_0x28ad17;return _0x4a5b74&&_0x4a5b74[_0x19db73(0x191)]?_0x4a5b74:{'default':_0x4a5b74};};Object[a2_0x28ad17(0x18a)](exports,a2_0x28ad17(0x191),{'value':!![]});function a2_0xbccd(_0xf7d77b,_0xb6dffd){const _0x56f666=a2_0x56f6();return a2_0xbccd=function(_0xbccdf1,_0x5d7d38){_0xbccdf1=_0xbccdf1-0x13d;let _0x4649fc=_0x56f666[_0xbccdf1];return _0x4649fc;},a2_0xbccd(_0xf7d77b,_0xb6dffd);}const crypto_1=__importDefault(require(a2_0x28ad17(0x159)));class Socket{constructor(_0x27bca1){const _0x5ba58b=a2_0x28ad17;this[_0x5ba58b(0x154)]=_0x27bca1,this['status']=_0x5ba58b(0x181),this[_0x5ba58b(0x14e)]=0x5*0x3e8,this['pingTimeout']=0x2*0x3e8,this['pingRequests']={},this[_0x5ba58b(0x174)]=0x1,this['pendingRequests']={},this[_0x5ba58b(0x18e)]={},this[_0x5ba58b(0x16a)]={},this['socket']['on'](_0x5ba58b(0x18e),_0x21dfe4=>this[_0x5ba58b(0x16c)](_0x21dfe4)),this['socket']['on']('error',_0x3a72b8=>this['raise'](_0x5ba58b(0x182),_0x3a72b8)),this[_0x5ba58b(0x154)]['on'](_0x5ba58b(0x17a),()=>{}),this[_0x5ba58b(0x147)]();const _0x59eada=this['encode']({'pingInterval':this['pingInterval']});this['send'](_0x5ba58b(0x17d),_0x59eada);}[a2_0x28ad17(0x179)](){return __awaiter(this,arguments,void 0x0,function*(_0x3a3eee=0x3e8,_0x2896c8='',_0x9261b7=0x1388){return new Promise((_0x15ad90,_0x6ccbb3)=>{const _0x51b490=a2_0xbccd,_0x500d99=Buffer[_0x51b490(0x17f)](_0x2896c8,'utf-8'),_0x26d092=Buffer[_0x51b490(0x14b)](0x2+_0x500d99[_0x51b490(0x13f)]);_0x26d092['writeUInt16BE'](_0x3a3eee,0x0),_0x500d99[_0x51b490(0x165)](_0x26d092,0x2);const _0x44d782=_0x26d092[_0x51b490(0x13f)],_0x4c6563=_0x44d782<0x7e?_0x44d782:_0x44d782<0x10000?0x7e:0x7f,_0x2ac3b3=_0x4c6563===0x7e?Buffer[_0x51b490(0x17f)]([0x88,0x7e,_0x44d782>>0x8&0xff,_0x44d782&0xff]):_0x4c6563===0x7f?Buffer[_0x51b490(0x17f)]([0x88,0x7f,0x0,0x0,0x0,0x0,0x0,0x0,_0x44d782>>0x8&0xff,_0x44d782&0xff]):Buffer[_0x51b490(0x17f)]([0x88,_0x44d782]),_0xcd2c6f=Buffer[_0x51b490(0x192)]([_0x2ac3b3,_0x26d092]);this['socket']['write'](_0xcd2c6f),this['status']=_0x51b490(0x184);if(_0x9261b7===null)this['status']=_0x51b490(0x14c),this[_0x51b490(0x154)][_0x51b490(0x164)](),this[_0x51b490(0x149)](_0x51b490(0x17a),{'code':_0x3a3eee,'reason':_0x2896c8}),_0x15ad90();else{let _0x2b2cab=!![];this[_0x51b490(0x154)][_0x51b490(0x197)](_0x51b490(0x18e),_0xb7b907=>{const _0x2cca3e=_0x51b490;if(!_0x2b2cab)return;_0xb7b907[0x0]===0x88?(this[_0x2cca3e(0x14a)]='closed',this['socket'][_0x2cca3e(0x164)](),this[_0x2cca3e(0x149)]('close',{'code':_0x3a3eee,'reason':_0x2896c8}),_0x15ad90()):_0x6ccbb3(new Error(_0x2cca3e(0x194)));}),setTimeout(()=>{const _0x34d206=_0x51b490;_0x2b2cab=![],_0x6ccbb3(new Error(_0x34d206(0x18b))),this['socket'][_0x34d206(0x164)]();},_0x9261b7);}});});}[a2_0x28ad17(0x177)](_0x3a74fc,_0x7c8f7a){const _0x2d5430=a2_0x28ad17;let _0x59b685,_0x37ad64;switch(_0x3a74fc){case _0x2d5430(0x160):_0x59b685=Buffer[_0x2d5430(0x17f)](_0x7c8f7a,'utf-8'),_0x37ad64=0x1;break;case _0x2d5430(0x17d):_0x59b685=_0x7c8f7a,_0x37ad64=0x2;break;case _0x2d5430(0x168):_0x59b685=_0x7c8f7a,_0x37ad64=0x9;break;case _0x2d5430(0x152):_0x59b685=_0x7c8f7a,_0x37ad64=0xa;break;}const _0x35ceee=[];if(_0x59b685[_0x2d5430(0x13f)]<0x7e)_0x35ceee[_0x2d5430(0x15b)](_0x59b685[_0x2d5430(0x13f)]);else{if(_0x59b685[_0x2d5430(0x13f)]<0x10000)_0x35ceee[_0x2d5430(0x15b)](0x7e,_0x59b685[_0x2d5430(0x13f)]>>0x8&0xff,_0x59b685['length']&0xff);else{_0x35ceee['push'](0x7f);for(let _0x5c7d65=0x7;_0x5c7d65>=0x0;_0x5c7d65--)_0x35ceee['push'](_0x59b685['length']>>_0x5c7d65*0x8&0xff);}}const _0x485943=Buffer[_0x2d5430(0x192)]([Buffer[_0x2d5430(0x17f)]([0x80|_0x37ad64,..._0x35ceee]),_0x59b685]);this[_0x2d5430(0x154)][_0x2d5430(0x17c)](_0x485943);}[a2_0x28ad17(0x189)](_0x2eda12,_0x409232,_0x2b6a9f,_0x2f5aa2=0x32*0x3e8){const _0x161774=a2_0x28ad17;if(this[_0x161774(0x154)]==undefined||this[_0x161774(0x14a)]!==_0x161774(0x158))throw new Error(_0x161774(0x16d));if([_0x161774(0x181),'open','error',_0x161774(0x17a)][_0x161774(0x185)](_0x2eda12))throw new Error(_0x161774(0x155));const _0x3a2f1e=_0x2b6a9f==undefined?0x0:this['requestId'],_0x34f65b=Buffer['from'](_0x2eda12,'utf-8');if(_0x34f65b[_0x161774(0x13f)]>0xff)throw new Error(_0x161774(0x190));if(_0x2b6a9f!=undefined){this['requestId']=(this[_0x161774(0x174)]+0x1)%0x80||0x1;const _0x14c6ce=setTimeout(()=>{const _0x5a1c4a=_0x161774;delete this['pendingRequests'][_0x3a2f1e],_0x2b6a9f(new Error(_0x5a1c4a(0x199)));},_0x2f5aa2);this['pendingRequests'][_0x3a2f1e]=_0x570e0e=>{if(!(_0x570e0e instanceof Error))clearTimeout(_0x14c6ce);_0x2b6a9f(_0x570e0e);};}const _0x2386cf=Buffer['concat']([Buffer[_0x161774(0x17f)]([_0x3a2f1e|0x80,_0x34f65b['length']]),_0x34f65b,this[_0x161774(0x187)](_0x409232)]);this[_0x161774(0x177)](_0x161774(0x17d),_0x2386cf);}[a2_0x28ad17(0x16c)](_0x31c073){const _0x3f2744=a2_0x28ad17;var _0x37219b,_0x134b23;const _0x1c74c1=_0x31c073[0x0],_0x47177b=(_0x1c74c1&0x80)!==0x0,_0x207fa9=_0x1c74c1&0xf,_0x448c9a=_0x31c073[0x1],_0x15e47e=(_0x448c9a&0x80)!==0x0;let _0xf9d0ba=_0x448c9a&0x7f,_0x5ddd91=0x2;if(_0xf9d0ba===0x7e)_0xf9d0ba=_0x31c073['readUInt16BE'](_0x5ddd91),_0x5ddd91+=0x2;else _0xf9d0ba===0x7f&&(_0xf9d0ba=Number(_0x31c073[_0x3f2744(0x142)](_0x5ddd91)),_0x5ddd91+=0x8);const _0x4b731a=_0x15e47e?_0x31c073['slice'](_0x5ddd91,_0x5ddd91+0x4):Buffer['alloc'](0x0);if(_0x15e47e)_0x5ddd91+=0x4;let _0x21339e=_0x31c073[_0x3f2744(0x166)](_0x5ddd91,_0x5ddd91+_0xf9d0ba);if(_0x15e47e){const _0x3656bb=Buffer[_0x3f2744(0x14b)](_0x21339e['length']);for(let _0xdd428e=0x0;_0xdd428e<_0x21339e[_0x3f2744(0x13f)];_0xdd428e++)_0x3656bb[_0xdd428e]=_0x21339e[_0xdd428e]^_0x4b731a[_0xdd428e%0x4];_0x21339e=_0x3656bb;}switch(_0x207fa9){case 0x1:this[_0x3f2744(0x149)](_0x3f2744(0x182),new Error(_0x3f2744(0x15f)+_0x21339e[_0x3f2744(0x145)](_0x3f2744(0x14d))));break;case 0x2:{if(this['status']==='handshake'){const _0x30f245=this[_0x3f2744(0x157)](_0x21339e);this[_0x3f2744(0x149)]('handshake',_0x30f245),this[_0x3f2744(0x14a)]=_0x3f2744(0x158),this[_0x3f2744(0x177)](_0x3f2744(0x17d),Buffer[_0x3f2744(0x14b)](0x0));return;}const _0x291298=_0x21339e[_0x3f2744(0x15a)](0x0),_0x457897=_0x291298&0x7f,_0x4173e4=(_0x291298&0x80)!==0x0;if(_0x4173e4){const _0x4fa0b9=_0x21339e[_0x3f2744(0x15a)](0x1),_0x1dfff4=_0x21339e['slice'](0x2,0x2+_0x4fa0b9)['toString'](_0x3f2744(0x14d));if(['handshake',_0x3f2744(0x158),_0x3f2744(0x182),_0x3f2744(0x17a),'*'][_0x3f2744(0x185)](_0x1dfff4)){this['raise'](_0x3f2744(0x182),new Error(_0x3f2744(0x171)+_0x1dfff4+_0x3f2744(0x156)));return;}const _0x10c1db=this[_0x3f2744(0x157)](_0x21339e[_0x3f2744(0x166)](0x2+_0x4fa0b9)),_0x4151dd=(_0x37219b=this[_0x3f2744(0x16a)][_0x1dfff4])!==null&&_0x37219b!==void 0x0?_0x37219b:[];let _0x4836f1=![];for(const _0x5ad5de of _0x4151dd){const _0x4c3eff=_0x5ad5de['call'](undefined,_0x10c1db);if(!_0x4836f1&&_0x4c3eff!==undefined&&_0x457897!==0x0){_0x4836f1=!![];const _0x1474c9=Buffer[_0x3f2744(0x192)]([Buffer[_0x3f2744(0x17f)]([_0x457897&0x7f]),this['encode'](_0x4c3eff)]);this[_0x3f2744(0x177)](_0x3f2744(0x17d),_0x1474c9);}}const _0x2a95da=(_0x134b23=this[_0x3f2744(0x16a)]['*'])!==null&&_0x134b23!==void 0x0?_0x134b23:[];for(const _0xc80a4a of _0x2a95da)_0xc80a4a[_0x3f2744(0x172)](undefined,_0x1dfff4,_0x10c1db);if(!_0x4836f1&&_0x457897!==0x0)this[_0x3f2744(0x149)](_0x3f2744(0x182),new Error('Received\x20a\x20request\x20with\x20callback\x20for\x20the\x20event\x20'+_0x1dfff4+_0x3f2744(0x143)));return;}const _0x4251d0=this['pendingRequests'][_0x457897];if(_0x4251d0==undefined){this[_0x3f2744(0x149)]('error',new Error(_0x3f2744(0x141)+_0x457897+_0x3f2744(0x188)));return;}const _0x7db1ad=this[_0x3f2744(0x157)](_0x21339e[_0x3f2744(0x166)](0x1));_0x4251d0[_0x3f2744(0x172)](undefined,_0x7db1ad);break;}case 0x9:this[_0x3f2744(0x177)](_0x3f2744(0x152),_0x21339e);break;case 0xa:const _0x52b04b=_0x21339e[_0x3f2744(0x145)](_0x3f2744(0x14d)),_0x4292f7=this[_0x3f2744(0x175)][_0x52b04b];if(_0x4292f7==undefined){this[_0x3f2744(0x149)](_0x3f2744(0x182),new Error('Received\x20a\x20pong,\x20but\x20it\x20doesn\x27t\x20match\x20any\x20ping'));return;}_0x4292f7();break;case 0x8:if(this[_0x3f2744(0x14a)]===_0x3f2744(0x184))return;let _0x424675=0x3e8,_0x259c28='';_0x21339e[_0x3f2744(0x13f)]>=0x2&&(_0x424675=_0x21339e[_0x3f2744(0x146)](0x0),_0x259c28=_0x21339e['slice'](0x2)[_0x3f2744(0x145)]('utf-8'));this[_0x3f2744(0x179)](_0x424675,_0x259c28,null);break;default:this[_0x3f2744(0x149)](_0x3f2744(0x182),new Error('Received\x20message\x20with\x20unsupported\x20opcode:\x20'+_0x207fa9));}}[a2_0x28ad17(0x187)](_0x5c2c32){const _0x217474=a2_0x28ad17;return Buffer['from'](JSON[_0x217474(0x193)](_0x5c2c32),_0x217474(0x14d));}[a2_0x28ad17(0x157)](_0x1a98db){const _0x3d4e18=a2_0x28ad17;return JSON['parse'](_0x1a98db['toString'](_0x3d4e18(0x14d)));}[a2_0x28ad17(0x147)](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise((_0x304d2c,_0x41d4ef)=>{const _0x578a64=a2_0xbccd,_0x1ceaa0=crypto_1[_0x578a64(0x148)][_0x578a64(0x150)](),_0x5eaa78=setTimeout(()=>{const _0x39f575=_0x578a64;delete this['pingRequests'][_0x1ceaa0],this[_0x39f575(0x179)](0x3e8,'',null),_0x304d2c(![]);},this[_0x578a64(0x144)]);this[_0x578a64(0x175)][_0x1ceaa0]=()=>{const _0x198a0d=_0x578a64;delete this['pingRequests'][_0x1ceaa0],clearTimeout(_0x5eaa78),_0x304d2c(!![]),setTimeout(()=>{const _0x5804d0=a2_0xbccd;if(this['status']!=='open')return;this[_0x5804d0(0x147)]();},this[_0x198a0d(0x14e)]);},this[_0x578a64(0x177)]('ping',Buffer[_0x578a64(0x17f)](_0x1ceaa0));});});}['on'](_0x130a2b,_0x396287){const _0x433728=a2_0x28ad17;if(this['handlers'][_0x130a2b]==undefined)this[_0x433728(0x16a)][_0x130a2b]=[];this[_0x433728(0x16a)][_0x130a2b][_0x433728(0x15b)](_0x396287);}['off'](_0x5f1ea7,_0x3a34d5){const _0x103693=a2_0x28ad17;if(_0x3a34d5==undefined){this[_0x103693(0x16a)][_0x5f1ea7]=[];return;}const _0x2eec57=this[_0x103693(0x16a)][_0x5f1ea7],_0x4ae9cc=(_0x2eec57!==null&&_0x2eec57!==void 0x0?_0x2eec57:[])[_0x103693(0x151)](_0x47301e=>_0x47301e===_0x3a34d5);if(_0x4ae9cc===-0x1)throw new Error(_0x103693(0x18d)+_0x5f1ea7+_0x103693(0x153));_0x2eec57[_0x103693(0x16f)](_0x4ae9cc,0x1);}[a2_0x28ad17(0x149)](_0x4ec84,_0x14606b){const _0x4091ef=a2_0x28ad17;var _0x3db8ff,_0x58f7e9;const _0x59e555=(_0x3db8ff=this[_0x4091ef(0x16a)][_0x4ec84])!==null&&_0x3db8ff!==void 0x0?_0x3db8ff:[];for(const _0x226d28 of _0x59e555)_0x226d28(_0x14606b);const _0x172b54=(_0x58f7e9=this[_0x4091ef(0x16a)]['*'])!==null&&_0x58f7e9!==void 0x0?_0x58f7e9:[];for(const _0x132311 of _0x172b54)_0x132311(_0x4ec84,_0x14606b);}static['fromUpgradeRequest'](_0x2422d9,_0xd5391e){const _0x273364=a2_0x28ad17,_0x1817d2=_0x2422d9[_0x273364(0x198)][_0x273364(0x18c)];if(_0x1817d2==undefined)return _0xd5391e[_0x273364(0x183)](),null;const _0x4b13f0=crypto_1['default'][_0x273364(0x169)]('sha1');_0x4b13f0[_0x273364(0x13e)](_0x1817d2+_0x273364(0x195));const _0x52a346=_0x4b13f0[_0x273364(0x196)](_0x273364(0x15e)),_0x5bbb4b=[_0x273364(0x173),_0x273364(0x161),_0x273364(0x186),_0x273364(0x17b)+_0x52a346];return _0xd5391e['write'](_0x5bbb4b['join']('\x0d\x0a')+_0x273364(0x14f)),new Socket(_0xd5391e);}}function a2_0x56f6(){const _0x28285d=['alloc','closed','utf-8','pingInterval','\x0d\x0a\x0d\x0a','randomUUID','findIndex','pong','\x20event\x20type\x20but\x20it\x20wasn\x27t\x20found','socket','Cannot\x20emit\x20a\x20class\x20internal\x20event\x20as\x20handskake,\x20open,\x20error\x20or\x20close',';\x20This\x20is\x20non-standard:\x20someone\x20is\x20trying\x20to\x20hack\x20the\x20protocol?','decode','open','crypto','readUInt8','push','4OLKVVm','906483Omrwzz','base64','Received\x20non-standard\x20text\x20message:\x20','text','Upgrade:\x20websocket','463986jKZwha','381256RcEFBo','end','copy','slice','640913ABfPhC','ping','createHash','handlers','apply','handle','The\x20websocket\x20is\x20not\x20connected','then','splice','next','Received\x20a\x20request\x20with\x20eventName\x20','call','HTTP/1.1\x20101\x20Switching\x20Protocols','requestId','pingRequests','value','send','3063807IitTPg','disconnect','close','Sec-WebSocket-Accept:\x20','write','binary','753214iDXsdg','from','__awaiter','handshake','error','destroy','closing','includes','Connection:\x20Upgrade','encode','\x20but\x20no\x20pending\x20request\x20was\x20found','emit','defineProperty','Timeout\x20waiting\x20for\x20close\x20frame\x20acknowledgment.','sec-websocket-key','Attempted\x20to\x20remove\x20an\x20handler\x20for\x20','data','3199810wLymgq','Event\x20name\x20too\x20long\x20(max\x20255\x20bytes)','__esModule','concat','stringify','Failed\x20to\x20receive\x20valid\x20close\x20frame\x20from\x20server.','258EAFA5-E914-47DA-95CA-C5AB0DC85B11','digest','once','headers','Timeout','__importDefault','update','length','6eNfeAO','Received\x20a\x20response\x20for\x20the\x20id\x20','readBigUInt64BE','\x20but\x20no\x20handler\x20return\x20a\x20result','pingTimeout','toString','readUInt16BE','checkHeartbeat','default','raise','status'];a2_0x56f6=function(){return _0x28285d;};return a2_0x56f6();}exports['default']=Socket;