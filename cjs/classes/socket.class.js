'use strict';const a2_0x45e561=a2_0x2b8e;(function(_0x2af8dc,_0x2eaf49){const _0x404580=a2_0x2b8e,_0x3493db=_0x2af8dc();while(!![]){try{const _0x2a3182=parseInt(_0x404580(0xc7))/0x1*(parseInt(_0x404580(0xa8))/0x2)+parseInt(_0x404580(0xef))/0x3*(-parseInt(_0x404580(0xa7))/0x4)+parseInt(_0x404580(0xca))/0x5*(-parseInt(_0x404580(0xde))/0x6)+-parseInt(_0x404580(0xad))/0x7*(parseInt(_0x404580(0xc3))/0x8)+-parseInt(_0x404580(0xd6))/0x9*(parseInt(_0x404580(0xdd))/0xa)+parseInt(_0x404580(0xf6))/0xb*(-parseInt(_0x404580(0xc4))/0xc)+parseInt(_0x404580(0xd4))/0xd;if(_0x2a3182===_0x2eaf49)break;else _0x3493db['push'](_0x3493db['shift']());}catch(_0xf0b659){_0x3493db['push'](_0x3493db['shift']());}}}(a2_0x3d4c,0xafa51));var __awaiter=this&&this[a2_0x45e561(0xcf)]||function(_0xf5b03c,_0x9d44f,_0x54f23c,_0x4f8104){function _0x1fa58f(_0x383533){return _0x383533 instanceof _0x54f23c?_0x383533:new _0x54f23c(function(_0xa52a84){_0xa52a84(_0x383533);});}return new(_0x54f23c||(_0x54f23c=Promise))(function(_0x403e04,_0xeb9d6){const _0x32e538=a2_0x2b8e;function _0x115891(_0x373295){const _0xfc1449=a2_0x2b8e;try{_0xa8c308(_0x4f8104[_0xfc1449(0x100)](_0x373295));}catch(_0x37b316){_0xeb9d6(_0x37b316);}}function _0xdafd27(_0x1fbd1e){const _0x352e3d=a2_0x2b8e;try{_0xa8c308(_0x4f8104[_0x352e3d(0xcd)](_0x1fbd1e));}catch(_0x7bb27f){_0xeb9d6(_0x7bb27f);}}function _0xa8c308(_0xefc7c5){const _0x27bbb7=a2_0x2b8e;_0xefc7c5[_0x27bbb7(0xf4)]?_0x403e04(_0xefc7c5['value']):_0x1fa58f(_0xefc7c5[_0x27bbb7(0xf1)])[_0x27bbb7(0xeb)](_0x115891,_0xdafd27);}_0xa8c308((_0x4f8104=_0x4f8104[_0x32e538(0xc2)](_0xf5b03c,_0x9d44f||[]))[_0x32e538(0x100)]());});},__importDefault=this&&this[a2_0x45e561(0xf7)]||function(_0x36f0d1){const _0x2378d5=a2_0x45e561;return _0x36f0d1&&_0x36f0d1[_0x2378d5(0xc5)]?_0x36f0d1:{'default':_0x36f0d1};};function a2_0x3d4c(){const _0x286213=['disconnect','pingTimeout','call','open','Received\x20a\x20request\x20with\x20callback\x20for\x20the\x20event\x20','writeUInt16BE','write','handle','parse','pingInterval','then','socket','findIndex','Received\x20a\x20pong,\x20but\x20it\x20doesn\x27t\x20match\x20any\x20ping','41151QghVVs','includes','value','ping','encode','done','utf-8','22iWqhZM','__importDefault','decode','checkHeartbeat','send','splice','close','length','default','Received\x20message\x20with\x20unsupported\x20opcode:\x20','next','Connection:\x20Upgrade','The\x20websocket\x20is\x20not\x20connected','raise','error','Attempted\x20to\x20remove\x20an\x20handler\x20for\x20','pendingRequests','Event\x20name\x20too\x20long\x20(max\x20255\x20bytes)','92DYWKyM','379418NokrJP','handshake','258EAFA5-E914-47DA-95CA-C5AB0DC85B11','toString','join','30226QZYlgP','data','readUInt16BE','handlers','slice','\x20event\x20type\x20but\x20it\x20wasn\x27t\x20found','fromUpgradeRequest','from','alloc',';\x20This\x20is\x20non-standard:\x20someone\x20is\x20trying\x20to\x20hack\x20the\x20protocol?','once','push','Failed\x20to\x20receive\x20valid\x20close\x20frame\x20from\x20server.','\x0d\x0a\x0d\x0a','copy','binary','closing','sec-websocket-key','closed','emit','Timeout\x20waiting\x20for\x20close\x20frame\x20acknowledgment.','apply','80KwwLXS','1482240LXlowd','__esModule','headers','4HeeGHW','pong','Sec-WebSocket-Accept:\x20','185WeQBKv','readBigUInt64BE','Received\x20a\x20response\x20for\x20the\x20id\x20','throw','text','__awaiter','update','pingRequests','requestId','destroy','35857185HjrPsb','Cannot\x20emit\x20a\x20class\x20internal\x20event\x20as\x20handskake,\x20open,\x20error\x20or\x20close','29961kJXpJO','concat','status','readUInt8','Upgrade:\x20websocket','locals','\x20but\x20no\x20pending\x20request\x20was\x20found','3580CkrssW','162186VClEPF','off','end'];a2_0x3d4c=function(){return _0x286213;};return a2_0x3d4c();}function a2_0x2b8e(_0x27b9b2,_0x5def70){const _0x3d4c46=a2_0x3d4c();return a2_0x2b8e=function(_0x2b8e75,_0x87fb61){_0x2b8e75=_0x2b8e75-0xa4;let _0x34448a=_0x3d4c46[_0x2b8e75];return _0x34448a;},a2_0x2b8e(_0x27b9b2,_0x5def70);}Object['defineProperty'](exports,a2_0x45e561(0xc5),{'value':!![]});const crypto_1=__importDefault(require('crypto'));class Socket{constructor(_0x35329b){const _0x18b4f8=a2_0x45e561;this[_0x18b4f8(0xec)]=_0x35329b,this['status']='handshake',this[_0x18b4f8(0xea)]=0x5*0x3e8,this['pingTimeout']=0x2*0x3e8,this['pingRequests']={},this['requestId']=0x1,this[_0x18b4f8(0xa5)]={},this[_0x18b4f8(0xdb)]={},this[_0x18b4f8(0xb0)]={},this[_0x18b4f8(0xec)]['on']('data',_0x381019=>this[_0x18b4f8(0xe8)](_0x381019)),this[_0x18b4f8(0xec)]['on'](_0x18b4f8(0x104),_0x5a469b=>this['raise']('error',_0x5a469b)),this[_0x18b4f8(0xec)]['on']('close',()=>{}),this['checkHeartbeat']();const _0x889732=this['encode']({'pingInterval':this[_0x18b4f8(0xea)]});this[_0x18b4f8(0xfa)](_0x18b4f8(0xbc),_0x889732);}['disconnect'](){return __awaiter(this,arguments,void 0x0,function*(_0x28f37a=0x3e8,_0x3b9dd9='',_0x1667bd=0x1388){return new Promise((_0x2d9974,_0x3674b1)=>{const _0x4067bc=a2_0x2b8e,_0x147dec=Buffer[_0x4067bc(0xb4)](_0x3b9dd9,_0x4067bc(0xf5)),_0xa68de6=Buffer[_0x4067bc(0xb5)](0x2+_0x147dec[_0x4067bc(0xfd)]);_0xa68de6[_0x4067bc(0xe6)](_0x28f37a,0x0),_0x147dec[_0x4067bc(0xbb)](_0xa68de6,0x2);const _0x21d918=_0xa68de6['length'],_0x92f629=_0x21d918<0x7e?_0x21d918:_0x21d918<0x10000?0x7e:0x7f,_0x341837=_0x92f629===0x7e?Buffer[_0x4067bc(0xb4)]([0x88,0x7e,_0x21d918>>0x8&0xff,_0x21d918&0xff]):_0x92f629===0x7f?Buffer['from']([0x88,0x7f,0x0,0x0,0x0,0x0,0x0,0x0,_0x21d918>>0x8&0xff,_0x21d918&0xff]):Buffer['from']([0x88,_0x21d918]),_0x57665d=Buffer[_0x4067bc(0xd7)]([_0x341837,_0xa68de6]);this['socket'][_0x4067bc(0xe7)](_0x57665d),this['status']='closing';if(_0x1667bd===null)this[_0x4067bc(0xd8)]=_0x4067bc(0xbf),this[_0x4067bc(0xec)][_0x4067bc(0xe0)](),this['raise'](_0x4067bc(0xfc),{'code':_0x28f37a,'reason':_0x3b9dd9}),_0x2d9974();else{let _0x40d535=!![];this[_0x4067bc(0xec)][_0x4067bc(0xb7)](_0x4067bc(0xae),_0x4f5b7e=>{const _0x5623c5=_0x4067bc;if(!_0x40d535)return;_0x4f5b7e[0x0]===0x88?(this[_0x5623c5(0xd8)]=_0x5623c5(0xbf),this[_0x5623c5(0xec)][_0x5623c5(0xe0)](),this[_0x5623c5(0x103)](_0x5623c5(0xfc),{'code':_0x28f37a,'reason':_0x3b9dd9}),_0x2d9974()):_0x3674b1(new Error(_0x5623c5(0xb9)));}),setTimeout(()=>{const _0x33281b=_0x4067bc;_0x40d535=![],_0x3674b1(new Error(_0x33281b(0xc1))),this[_0x33281b(0xec)]['end']();},_0x1667bd);}});});}[a2_0x45e561(0xfa)](_0x2818b8,_0x4aac07){const _0x31b271=a2_0x45e561;let _0x204a69,_0x2d0c5;switch(_0x2818b8){case _0x31b271(0xce):_0x204a69=Buffer[_0x31b271(0xb4)](_0x4aac07,_0x31b271(0xf5)),_0x2d0c5=0x1;break;case _0x31b271(0xbc):_0x204a69=_0x4aac07,_0x2d0c5=0x2;break;case _0x31b271(0xf2):_0x204a69=_0x4aac07,_0x2d0c5=0x9;break;case _0x31b271(0xc8):_0x204a69=_0x4aac07,_0x2d0c5=0xa;break;}const _0x4abea3=[];if(_0x204a69[_0x31b271(0xfd)]<0x7e)_0x4abea3[_0x31b271(0xb8)](_0x204a69[_0x31b271(0xfd)]);else{if(_0x204a69[_0x31b271(0xfd)]<0x10000)_0x4abea3[_0x31b271(0xb8)](0x7e,_0x204a69['length']>>0x8&0xff,_0x204a69['length']&0xff);else{_0x4abea3[_0x31b271(0xb8)](0x7f);for(let _0x120c6a=0x7;_0x120c6a>=0x0;_0x120c6a--)_0x4abea3[_0x31b271(0xb8)](_0x204a69[_0x31b271(0xfd)]>>_0x120c6a*0x8&0xff);}}const _0x51aa72=Buffer['concat']([Buffer[_0x31b271(0xb4)]([0x80|_0x2d0c5,..._0x4abea3]),_0x204a69]);this['socket'][_0x31b271(0xe7)](_0x51aa72);}[a2_0x45e561(0xc0)](_0x915aae,_0x1c70e0,_0x12e06a,_0x4c49b3=0x32*0x3e8){const _0x46b742=a2_0x45e561;if(this['socket']==undefined||this[_0x46b742(0xd8)]!==_0x46b742(0xe4))throw new Error(_0x46b742(0x102));if([_0x46b742(0xa9),_0x46b742(0xe4),'error',_0x46b742(0xfc)][_0x46b742(0xf0)](_0x915aae))throw new Error(_0x46b742(0xd5));const _0x123e9c=_0x12e06a==undefined?0x0:this['requestId'],_0x13a38b=Buffer[_0x46b742(0xb4)](_0x915aae,_0x46b742(0xf5));if(_0x13a38b['length']>0xff)throw new Error(_0x46b742(0xa6));if(_0x12e06a!=undefined){this[_0x46b742(0xd2)]=(this['requestId']+0x1)%0x80||0x1;const _0x2a2fd8=setTimeout(()=>{const _0x1e2cf1=_0x46b742;delete this[_0x1e2cf1(0xa5)][_0x123e9c],_0x12e06a(new Error('Timeout'));},_0x4c49b3);this['pendingRequests'][_0x123e9c]=_0x31ab0b=>{if(!(_0x31ab0b instanceof Error))clearTimeout(_0x2a2fd8);_0x12e06a(_0x31ab0b);};}const _0x24cc83=Buffer[_0x46b742(0xd7)]([Buffer['from']([_0x123e9c|0x80,_0x13a38b[_0x46b742(0xfd)]]),_0x13a38b,this['encode'](_0x1c70e0)]);this[_0x46b742(0xfa)]('binary',_0x24cc83);}['handle'](_0x38501c){const _0x45a82a=a2_0x45e561;var _0x4f2e51;const _0xffdf09=_0x38501c[0x0],_0x50f818=(_0xffdf09&0x80)!==0x0,_0x536eac=_0xffdf09&0xf,_0x179a0e=_0x38501c[0x1],_0x30a383=(_0x179a0e&0x80)!==0x0;let _0x496ad0=_0x179a0e&0x7f,_0x4e1a1b=0x2;if(_0x496ad0===0x7e)_0x496ad0=_0x38501c[_0x45a82a(0xaf)](_0x4e1a1b),_0x4e1a1b+=0x2;else _0x496ad0===0x7f&&(_0x496ad0=Number(_0x38501c[_0x45a82a(0xcb)](_0x4e1a1b)),_0x4e1a1b+=0x8);const _0x5cd2ed=_0x30a383?_0x38501c[_0x45a82a(0xb1)](_0x4e1a1b,_0x4e1a1b+0x4):Buffer[_0x45a82a(0xb5)](0x0);if(_0x30a383)_0x4e1a1b+=0x4;let _0x1e32b2=_0x38501c[_0x45a82a(0xb1)](_0x4e1a1b,_0x4e1a1b+_0x496ad0);if(_0x30a383){const _0x323284=Buffer[_0x45a82a(0xb5)](_0x1e32b2[_0x45a82a(0xfd)]);for(let _0x41679f=0x0;_0x41679f<_0x1e32b2[_0x45a82a(0xfd)];_0x41679f++)_0x323284[_0x41679f]=_0x1e32b2[_0x41679f]^_0x5cd2ed[_0x41679f%0x4];_0x1e32b2=_0x323284;}switch(_0x536eac){case 0x1:this[_0x45a82a(0x103)](_0x45a82a(0x104),new Error('Received\x20non-standard\x20text\x20message:\x20'+_0x1e32b2['toString'](_0x45a82a(0xf5))));break;case 0x2:{if(this[_0x45a82a(0xd8)]===_0x45a82a(0xa9)){const _0x153754=this[_0x45a82a(0xf8)](_0x1e32b2);this[_0x45a82a(0x103)](_0x45a82a(0xa9),_0x153754),this[_0x45a82a(0xd8)]=_0x45a82a(0xe4),this[_0x45a82a(0xfa)](_0x45a82a(0xbc),Buffer[_0x45a82a(0xb5)](0x0));return;}const _0x488a05=_0x1e32b2[_0x45a82a(0xd9)](0x0),_0x2b40b9=_0x488a05&0x7f,_0x17400d=(_0x488a05&0x80)!==0x0;if(_0x17400d){const _0x3fc800=_0x1e32b2[_0x45a82a(0xd9)](0x1),_0x157f96=_0x1e32b2['slice'](0x2,0x2+_0x3fc800)[_0x45a82a(0xab)](_0x45a82a(0xf5));if([_0x45a82a(0xa9),_0x45a82a(0xe4),'error','close'][_0x45a82a(0xf0)](_0x157f96)){this[_0x45a82a(0x103)]('error',new Error('Received\x20a\x20request\x20with\x20eventName\x20'+_0x157f96+_0x45a82a(0xb6)));return;}const _0x1bcd39=this[_0x45a82a(0xf8)](_0x1e32b2[_0x45a82a(0xb1)](0x2+_0x3fc800)),_0x3a7303=(_0x4f2e51=this['handlers'][_0x157f96])!==null&&_0x4f2e51!==void 0x0?_0x4f2e51:[];let _0x216890=![];for(const _0x29608f of _0x3a7303){const _0x1b32a7=_0x29608f[_0x45a82a(0xe3)](undefined,_0x1bcd39);if(!_0x216890&&_0x1b32a7!==undefined&&_0x2b40b9!==0x0){_0x216890=!![];const _0x34cbe5=Buffer[_0x45a82a(0xd7)]([Buffer[_0x45a82a(0xb4)]([_0x2b40b9&0x7f]),this[_0x45a82a(0xf3)](_0x1b32a7)]);this['send'](_0x45a82a(0xbc),_0x34cbe5);}}if(!_0x216890&&_0x2b40b9!==0x0)this[_0x45a82a(0x103)](_0x45a82a(0x104),new Error(_0x45a82a(0xe5)+_0x157f96+'\x20but\x20no\x20handler\x20return\x20a\x20result'));return;}const _0x317883=this[_0x45a82a(0xa5)][_0x2b40b9];if(_0x317883==undefined){this[_0x45a82a(0x103)](_0x45a82a(0x104),new Error(_0x45a82a(0xcc)+_0x2b40b9+_0x45a82a(0xdc)));return;}const _0x5ec8fa=this[_0x45a82a(0xf8)](_0x1e32b2[_0x45a82a(0xb1)](0x1));_0x317883[_0x45a82a(0xe3)](undefined,_0x5ec8fa);break;}case 0x9:this['send'](_0x45a82a(0xc8),_0x1e32b2);break;case 0xa:const _0x43cfd6=_0x1e32b2[_0x45a82a(0xab)](_0x45a82a(0xf5)),_0x5e8690=this[_0x45a82a(0xd1)][_0x43cfd6];if(_0x5e8690==undefined){this[_0x45a82a(0x103)](_0x45a82a(0x104),new Error(_0x45a82a(0xee)));return;}_0x5e8690();break;case 0x8:if(this[_0x45a82a(0xd8)]===_0x45a82a(0xbd))return;let _0x27e637=0x3e8,_0x2704a2='';_0x1e32b2['length']>=0x2&&(_0x27e637=_0x1e32b2['readUInt16BE'](0x0),_0x2704a2=_0x1e32b2[_0x45a82a(0xb1)](0x2)['toString']('utf-8'));this['disconnect'](_0x27e637,_0x2704a2,null);break;default:this[_0x45a82a(0x103)](_0x45a82a(0x104),new Error(_0x45a82a(0xff)+_0x536eac));}}[a2_0x45e561(0xf3)](_0x9f95fc){const _0x5f3de1=a2_0x45e561;return Buffer['from'](JSON['stringify'](_0x9f95fc),_0x5f3de1(0xf5));}[a2_0x45e561(0xf8)](_0x378f4e){const _0x4aa09a=a2_0x45e561;return JSON[_0x4aa09a(0xe9)](_0x378f4e[_0x4aa09a(0xab)](_0x4aa09a(0xf5)));}[a2_0x45e561(0xf9)](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise((_0x47e882,_0x2c6e0b)=>{const _0x4ff0f5=a2_0x2b8e,_0x434d19=crypto_1[_0x4ff0f5(0xfe)]['randomUUID'](),_0x107a37=setTimeout(()=>{const _0x4f7582=_0x4ff0f5;delete this[_0x4f7582(0xd1)][_0x434d19],this[_0x4f7582(0xe1)](0x3e8,'',null),_0x47e882(![]);},this[_0x4ff0f5(0xe2)]);this['pingRequests'][_0x434d19]=()=>{const _0x3f767a=_0x4ff0f5;delete this[_0x3f767a(0xd1)][_0x434d19],clearTimeout(_0x107a37),_0x47e882(!![]),setTimeout(()=>{const _0x3e3462=_0x3f767a;if(this[_0x3e3462(0xd8)]!=='open')return;this[_0x3e3462(0xf9)]();},this['pingInterval']);},this[_0x4ff0f5(0xfa)](_0x4ff0f5(0xf2),Buffer[_0x4ff0f5(0xb4)](_0x434d19));});});}['on'](_0x5450e3,_0x1439c9){const _0x2025a8=a2_0x45e561;if(this[_0x2025a8(0xb0)][_0x5450e3]==undefined)this[_0x2025a8(0xb0)][_0x5450e3]=[];this['handlers'][_0x5450e3][_0x2025a8(0xb8)](_0x1439c9);}[a2_0x45e561(0xdf)](_0x2111f7,_0x13616c){const _0x2c928c=a2_0x45e561;if(_0x13616c==undefined){this[_0x2c928c(0xb0)][_0x2111f7]=[];return;}const _0x405097=this[_0x2c928c(0xb0)][_0x2111f7],_0x499ba0=(_0x405097!==null&&_0x405097!==void 0x0?_0x405097:[])[_0x2c928c(0xed)](_0x514416=>_0x514416===_0x13616c);if(_0x499ba0===-0x1)throw new Error(_0x2c928c(0xa4)+_0x2111f7+_0x2c928c(0xb2));_0x405097[_0x2c928c(0xfb)](_0x499ba0,0x1);}[a2_0x45e561(0x103)](_0xbce0c8,_0x74902a){var _0x56ae77;const _0x377d19=(_0x56ae77=this['handlers'][_0xbce0c8])!==null&&_0x56ae77!==void 0x0?_0x56ae77:[];for(const _0x3c74f8 of _0x377d19){_0x3c74f8(_0x74902a);}}static[a2_0x45e561(0xb3)](_0x3d7606,_0x4a0d64){const _0x4a0864=a2_0x45e561,_0x53cdff=_0x3d7606[_0x4a0864(0xc6)][_0x4a0864(0xbe)];if(_0x53cdff==undefined)return _0x4a0d64[_0x4a0864(0xd3)](),null;const _0x413a8e=crypto_1['default']['createHash']('sha1');_0x413a8e[_0x4a0864(0xd0)](_0x53cdff+_0x4a0864(0xaa));const _0x4078e3=_0x413a8e['digest']('base64'),_0x2b37d4=['HTTP/1.1\x20101\x20Switching\x20Protocols',_0x4a0864(0xda),_0x4a0864(0x101),_0x4a0864(0xc9)+_0x4078e3];return _0x4a0d64[_0x4a0864(0xe7)](_0x2b37d4[_0x4a0864(0xac)]('\x0d\x0a')+_0x4a0864(0xba)),new Socket(_0x4a0d64);}}exports['default']=Socket;