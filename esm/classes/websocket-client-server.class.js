const a4_0x3852cb=a4_0x313e;(function(_0x37e709,_0x59a0b5){const _0x1f904c=a4_0x313e,_0x539dd6=_0x37e709();while(!![]){try{const _0x21a36f=parseInt(_0x1f904c(0x8b))/0x1+-parseInt(_0x1f904c(0xba))/0x2+-parseInt(_0x1f904c(0xb4))/0x3+parseInt(_0x1f904c(0x7d))/0x4+parseInt(_0x1f904c(0x91))/0x5+parseInt(_0x1f904c(0xc4))/0x6+-parseInt(_0x1f904c(0xb2))/0x7*(parseInt(_0x1f904c(0x82))/0x8);if(_0x21a36f===_0x59a0b5)break;else _0x539dd6['push'](_0x539dd6['shift']());}catch(_0x1dc257){_0x539dd6['push'](_0x539dd6['shift']());}}}(a4_0xc8e9,0x9cdc8));var __awaiter=this&&this['__awaiter']||function(_0x40d3ce,_0x24659f,_0x14393b,_0x4676c5){function _0x3c24bd(_0x3df984){return _0x3df984 instanceof _0x14393b?_0x3df984:new _0x14393b(function(_0x34c5e7){_0x34c5e7(_0x3df984);});}return new(_0x14393b||(_0x14393b=Promise))(function(_0x3c7108,_0x2baa62){const _0x3d3f22=a4_0x313e;function _0x23ec62(_0x13e054){const _0x556ccd=a4_0x313e;try{_0x4bf4ec(_0x4676c5[_0x556ccd(0x7a)](_0x13e054));}catch(_0x47fbf5){_0x2baa62(_0x47fbf5);}}function _0x350999(_0xa8d650){const _0x3b4c29=a4_0x313e;try{_0x4bf4ec(_0x4676c5[_0x3b4c29(0xc5)](_0xa8d650));}catch(_0x2739e5){_0x2baa62(_0x2739e5);}}function _0x4bf4ec(_0xf6884f){const _0x3cc4ec=a4_0x313e;_0xf6884f[_0x3cc4ec(0xbf)]?_0x3c7108(_0xf6884f['value']):_0x3c24bd(_0xf6884f[_0x3cc4ec(0x6e)])[_0x3cc4ec(0x7b)](_0x23ec62,_0x350999);}_0x4bf4ec((_0x4676c5=_0x4676c5[_0x3d3f22(0x76)](_0x40d3ce,_0x24659f||[]))['next']());});};function a4_0x313e(_0x3ace64,_0x519e68){const _0xc8e9c2=a4_0xc8e9();return a4_0x313e=function(_0x313ee7,_0x55ceb5){_0x313ee7=_0x313ee7-0x6d;let _0x1f4030=_0xc8e9c2[_0x313ee7];return _0x1f4030;},a4_0x313e(_0x3ace64,_0x519e68);}import a4_0x43022d from'crypto';function a4_0xc8e9(){const _0x3a2d7c=['pingRequests','\x20event\x20type\x20but\x20it\x20wasn\x27t\x20found','Received\x20a\x20request\x20with\x20eventName\x20','apply','Received\x20non-standard\x20text\x20message:\x20','sha1','Cannot\x20emit\x20a\x20class\x20internal\x20event\x20as\x20handskake,\x20open,\x20error\x20or\x20close','next','then','pendingRequests','3124404qiNHXm','handshake','Upgrade:\x20websocket','socket','emit','379336SQanNd','disconnect','binary',';\x20This\x20is\x20non-standard:\x20someone\x20is\x20trying\x20to\x20hack\x20the\x20protocol?','headers','Connection:\x20Upgrade','splice','slice','from','409807fuSGAD','findIndex','pingInterval','alloc','base64','parse','2590775vxqMxt','Received\x20a\x20response\x20for\x20the\x20id\x20','includes','258EAFA5-E914-47DA-95CA-C5AB0DC85B11','handle','The\x20websocket\x20is\x20not\x20connected','raise','write','Timeout','once','\x20but\x20no\x20pending\x20request\x20was\x20found','writeUInt16BE','decode','ping','encode','pingTimeout','concat','closed','\x20but\x20no\x20handler\x20return\x20a\x20result','destroy','Received\x20a\x20request\x20with\x20callback\x20for\x20the\x20event\x20','push','Received\x20message\x20with\x20unsupported\x20opcode:\x20','Received\x20a\x20pong,\x20but\x20it\x20doesn\x27t\x20match\x20any\x20ping','handlers','createHash','sec-websocket-key','closing','readUInt8','toString','open','utf-8','Event\x20name\x20too\x20long\x20(max\x20255\x20bytes)','77RSzxis','HTTP/1.1\x20101\x20Switching\x20Protocols','2799231CqLGrS','digest','requestId','locals','join','fromUpgradeRequest','1198052oJdaAc','end','Failed\x20to\x20receive\x20valid\x20close\x20frame\x20from\x20server.','send','off','done','data','error','length','status','5922786CmJsMQ','throw','update','readUInt16BE','close','value','stringify','randomUUID','call','checkHeartbeat'];a4_0xc8e9=function(){return _0x3a2d7c;};return a4_0xc8e9();}export default class WebsocketClientServer{constructor(_0x30834e){const _0x435fca=a4_0x313e;this['socket']=_0x30834e,this[_0x435fca(0xc3)]='handshake',this[_0x435fca(0x8d)]=0x5*0x3e8,this[_0x435fca(0xa0)]=0x2*0x3e8,this[_0x435fca(0x73)]={},this[_0x435fca(0xb6)]=0x1,this['pendingRequests']={},this[_0x435fca(0xb7)]={},this[_0x435fca(0xa9)]={},this['socket']['on'](_0x435fca(0xc0),_0x4f8f18=>this[_0x435fca(0x95)](_0x4f8f18)),this[_0x435fca(0x80)]['on'](_0x435fca(0xc1),_0x7d837b=>this[_0x435fca(0x97)](_0x435fca(0xc1),_0x7d837b)),this['socket']['on'](_0x435fca(0x6d),()=>{}),this[_0x435fca(0x72)]();const _0x1b4b25=this[_0x435fca(0x9f)]({'pingInterval':this[_0x435fca(0x8d)]});this[_0x435fca(0xbd)](_0x435fca(0x84),_0x1b4b25);}[a4_0x3852cb(0x83)](){return __awaiter(this,arguments,void 0x0,function*(_0x4f1ae4=0x3e8,_0x220659='',_0x3e7c9f=0x1388){return new Promise((_0x43e9bc,_0x5f2808)=>{const _0x4724d2=a4_0x313e,_0x3285f4=Buffer[_0x4724d2(0x8a)](_0x220659,_0x4724d2(0xb0)),_0x1115c0=Buffer[_0x4724d2(0x8e)](0x2+_0x3285f4[_0x4724d2(0xc2)]);_0x1115c0[_0x4724d2(0x9c)](_0x4f1ae4,0x0),_0x3285f4['copy'](_0x1115c0,0x2);const _0xc29ebd=_0x1115c0[_0x4724d2(0xc2)],_0x5cbd81=_0xc29ebd<0x7e?_0xc29ebd:_0xc29ebd<0x10000?0x7e:0x7f,_0xef510c=_0x5cbd81===0x7e?Buffer[_0x4724d2(0x8a)]([0x88,0x7e,_0xc29ebd>>0x8&0xff,_0xc29ebd&0xff]):_0x5cbd81===0x7f?Buffer[_0x4724d2(0x8a)]([0x88,0x7f,0x0,0x0,0x0,0x0,0x0,0x0,_0xc29ebd>>0x8&0xff,_0xc29ebd&0xff]):Buffer[_0x4724d2(0x8a)]([0x88,_0xc29ebd]),_0x3cec4e=Buffer[_0x4724d2(0xa1)]([_0xef510c,_0x1115c0]);this[_0x4724d2(0x80)][_0x4724d2(0x98)](_0x3cec4e),this[_0x4724d2(0xc3)]='closing';if(_0x3e7c9f===null)this[_0x4724d2(0xc3)]=_0x4724d2(0xa2),this['socket'][_0x4724d2(0xbb)](),this[_0x4724d2(0x97)]('close',{'code':_0x4f1ae4,'reason':_0x220659}),_0x43e9bc();else{let _0x1294c1=!![];this[_0x4724d2(0x80)][_0x4724d2(0x9a)](_0x4724d2(0xc0),_0x4de2e7=>{const _0x23926b=_0x4724d2;if(!_0x1294c1)return;_0x4de2e7[0x0]===0x88?(this[_0x23926b(0xc3)]=_0x23926b(0xa2),this[_0x23926b(0x80)][_0x23926b(0xbb)](),this['raise'](_0x23926b(0x6d),{'code':_0x4f1ae4,'reason':_0x220659}),_0x43e9bc()):_0x5f2808(new Error(_0x23926b(0xbc)));}),setTimeout(()=>{const _0x66b4da=_0x4724d2;_0x1294c1=![],_0x5f2808(new Error('Timeout\x20waiting\x20for\x20close\x20frame\x20acknowledgment.')),this[_0x66b4da(0x80)][_0x66b4da(0xbb)]();},_0x3e7c9f);}});});}['send'](_0x46bae3,_0x59dddc){const _0xc98309=a4_0x3852cb;let _0x1668ab,_0x151b62;switch(_0x46bae3){case'text':_0x1668ab=Buffer[_0xc98309(0x8a)](_0x59dddc,_0xc98309(0xb0)),_0x151b62=0x1;break;case'binary':_0x1668ab=_0x59dddc,_0x151b62=0x2;break;case _0xc98309(0x9e):_0x1668ab=_0x59dddc,_0x151b62=0x9;break;case'pong':_0x1668ab=_0x59dddc,_0x151b62=0xa;break;}const _0x1510a1=[];if(_0x1668ab['length']<0x7e)_0x1510a1[_0xc98309(0xa6)](_0x1668ab[_0xc98309(0xc2)]);else{if(_0x1668ab[_0xc98309(0xc2)]<0x10000)_0x1510a1[_0xc98309(0xa6)](0x7e,_0x1668ab[_0xc98309(0xc2)]>>0x8&0xff,_0x1668ab[_0xc98309(0xc2)]&0xff);else{_0x1510a1['push'](0x7f);for(let _0x502363=0x7;_0x502363>=0x0;_0x502363--)_0x1510a1[_0xc98309(0xa6)](_0x1668ab[_0xc98309(0xc2)]>>_0x502363*0x8&0xff);}}const _0x5b47f5=Buffer['concat']([Buffer['from']([0x80|_0x151b62,..._0x1510a1]),_0x1668ab]);this[_0xc98309(0x80)][_0xc98309(0x98)](_0x5b47f5);}[a4_0x3852cb(0x81)](_0x50e113,_0x1067bb,_0x45547b,_0x1861d1=0x32*0x3e8){const _0x3bf701=a4_0x3852cb;if(this[_0x3bf701(0x80)]==undefined||this[_0x3bf701(0xc3)]!==_0x3bf701(0xaf))throw new Error(_0x3bf701(0x96));if([_0x3bf701(0x7e),_0x3bf701(0xaf),_0x3bf701(0xc1),_0x3bf701(0x6d)][_0x3bf701(0x93)](_0x50e113))throw new Error(_0x3bf701(0x79));const _0x46dfd9=_0x45547b==undefined?0x0:this['requestId'],_0x5c1599=Buffer['from'](_0x50e113,_0x3bf701(0xb0));if(_0x5c1599[_0x3bf701(0xc2)]>0xff)throw new Error(_0x3bf701(0xb1));if(_0x45547b!=undefined){this[_0x3bf701(0xb6)]=(this['requestId']+0x1)%0x80||0x1;const _0x547c8c=setTimeout(()=>{const _0x553a16=_0x3bf701;delete this[_0x553a16(0x7c)][_0x46dfd9],_0x45547b(new Error(_0x553a16(0x99)));},_0x1861d1);this[_0x3bf701(0x7c)][_0x46dfd9]=_0x36870e=>{if(!(_0x36870e instanceof Error))clearTimeout(_0x547c8c);_0x45547b(_0x36870e);};}const _0x52b391=Buffer['concat']([Buffer['from']([_0x46dfd9|0x80,_0x5c1599[_0x3bf701(0xc2)]]),_0x5c1599,this[_0x3bf701(0x9f)](_0x1067bb)]);this[_0x3bf701(0xbd)](_0x3bf701(0x84),_0x52b391);}[a4_0x3852cb(0x95)](_0x211c56){const _0x5633ed=a4_0x3852cb;var _0x2acbea;const _0xc615ec=_0x211c56[0x0],_0x45e8fa=(_0xc615ec&0x80)!==0x0,_0x39c371=_0xc615ec&0xf,_0x296f70=_0x211c56[0x1],_0xb181c8=(_0x296f70&0x80)!==0x0;let _0x128927=_0x296f70&0x7f,_0x3a317e=0x2;if(_0x128927===0x7e)_0x128927=_0x211c56[_0x5633ed(0xc7)](_0x3a317e),_0x3a317e+=0x2;else _0x128927===0x7f&&(_0x128927=Number(_0x211c56['readBigUInt64BE'](_0x3a317e)),_0x3a317e+=0x8);const _0x25830e=_0xb181c8?_0x211c56[_0x5633ed(0x89)](_0x3a317e,_0x3a317e+0x4):Buffer[_0x5633ed(0x8e)](0x0);if(_0xb181c8)_0x3a317e+=0x4;let _0x2b2660=_0x211c56['slice'](_0x3a317e,_0x3a317e+_0x128927);if(_0xb181c8){const _0x50c1c3=Buffer['alloc'](_0x2b2660[_0x5633ed(0xc2)]);for(let _0x2e43f6=0x0;_0x2e43f6<_0x2b2660[_0x5633ed(0xc2)];_0x2e43f6++)_0x50c1c3[_0x2e43f6]=_0x2b2660[_0x2e43f6]^_0x25830e[_0x2e43f6%0x4];_0x2b2660=_0x50c1c3;}switch(_0x39c371){case 0x1:this[_0x5633ed(0x97)]('error',new Error(_0x5633ed(0x77)+_0x2b2660[_0x5633ed(0xae)]('utf-8')));break;case 0x2:{if(this['status']==='handshake'){const _0x14bd61=this['decode'](_0x2b2660);this[_0x5633ed(0x97)](_0x5633ed(0x7e),_0x14bd61),this['status']=_0x5633ed(0xaf),this[_0x5633ed(0xbd)](_0x5633ed(0x84),Buffer['alloc'](0x0));return;}const _0x41f9e9=_0x2b2660[_0x5633ed(0xad)](0x0),_0x14933f=_0x41f9e9&0x7f,_0x526ab3=(_0x41f9e9&0x80)!==0x0;if(_0x526ab3){const _0x8ab892=_0x2b2660[_0x5633ed(0xad)](0x1),_0x3ed791=_0x2b2660[_0x5633ed(0x89)](0x2,0x2+_0x8ab892)['toString'](_0x5633ed(0xb0));if([_0x5633ed(0x7e),'open','error',_0x5633ed(0x6d)]['includes'](_0x3ed791)){this[_0x5633ed(0x97)](_0x5633ed(0xc1),new Error(_0x5633ed(0x75)+_0x3ed791+_0x5633ed(0x85)));return;}const _0x92f775=this[_0x5633ed(0x9d)](_0x2b2660[_0x5633ed(0x89)](0x2+_0x8ab892)),_0x108f4e=(_0x2acbea=this[_0x5633ed(0xa9)][_0x3ed791])!==null&&_0x2acbea!==void 0x0?_0x2acbea:[];let _0x4a2514=![];for(const _0x8d4dbc of _0x108f4e){const _0x125d93=_0x8d4dbc[_0x5633ed(0x71)](undefined,_0x92f775);if(!_0x4a2514&&_0x125d93!==undefined&&_0x14933f!==0x0){_0x4a2514=!![];const _0x34a9f0=Buffer[_0x5633ed(0xa1)]([Buffer[_0x5633ed(0x8a)]([_0x14933f&0x7f]),this['encode'](_0x125d93)]);this['send']('binary',_0x34a9f0);}}if(!_0x4a2514&&_0x14933f!==0x0)this[_0x5633ed(0x97)]('error',new Error(_0x5633ed(0xa5)+_0x3ed791+_0x5633ed(0xa3)));return;}const _0x5234f7=this[_0x5633ed(0x7c)][_0x14933f];if(_0x5234f7==undefined){this[_0x5633ed(0x97)](_0x5633ed(0xc1),new Error(_0x5633ed(0x92)+_0x14933f+_0x5633ed(0x9b)));return;}const _0x41d8df=this[_0x5633ed(0x9d)](_0x2b2660[_0x5633ed(0x89)](0x1));_0x5234f7[_0x5633ed(0x71)](undefined,_0x41d8df);break;}case 0x9:this[_0x5633ed(0xbd)]('pong',_0x2b2660);break;case 0xa:const _0x50227b=_0x2b2660[_0x5633ed(0xae)](_0x5633ed(0xb0)),_0x596dee=this[_0x5633ed(0x73)][_0x50227b];if(_0x596dee==undefined){this['raise'](_0x5633ed(0xc1),new Error(_0x5633ed(0xa8)));return;}_0x596dee();break;case 0x8:if(this[_0x5633ed(0xc3)]===_0x5633ed(0xac))return;let _0x30d7ff=0x3e8,_0x55c763='';_0x2b2660[_0x5633ed(0xc2)]>=0x2&&(_0x30d7ff=_0x2b2660[_0x5633ed(0xc7)](0x0),_0x55c763=_0x2b2660[_0x5633ed(0x89)](0x2)[_0x5633ed(0xae)](_0x5633ed(0xb0)));this[_0x5633ed(0x83)](_0x30d7ff,_0x55c763,null);break;default:this['raise'](_0x5633ed(0xc1),new Error(_0x5633ed(0xa7)+_0x39c371));}}[a4_0x3852cb(0x9f)](_0x5eb573){const _0x480a53=a4_0x3852cb;return Buffer[_0x480a53(0x8a)](JSON[_0x480a53(0x6f)](_0x5eb573),_0x480a53(0xb0));}['decode'](_0x3bdffc){const _0xb1b490=a4_0x3852cb;return JSON[_0xb1b490(0x90)](_0x3bdffc['toString'](_0xb1b490(0xb0)));}[a4_0x3852cb(0x72)](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise((_0x4ef2e6,_0x4a8675)=>{const _0x389b64=a4_0x313e,_0xd4cb9e=a4_0x43022d[_0x389b64(0x70)](),_0x37ded0=setTimeout(()=>{const _0x338ea1=_0x389b64;delete this[_0x338ea1(0x73)][_0xd4cb9e],this[_0x338ea1(0x83)](0x3e8,'',null),_0x4ef2e6(![]);},this[_0x389b64(0xa0)]);this[_0x389b64(0x73)][_0xd4cb9e]=()=>{const _0x1a35dc=_0x389b64;delete this['pingRequests'][_0xd4cb9e],clearTimeout(_0x37ded0),_0x4ef2e6(!![]),setTimeout(()=>{const _0x4ff3b9=a4_0x313e;if(this[_0x4ff3b9(0xc3)]!==_0x4ff3b9(0xaf))return;this[_0x4ff3b9(0x72)]();},this[_0x1a35dc(0x8d)]);},this[_0x389b64(0xbd)](_0x389b64(0x9e),Buffer['from'](_0xd4cb9e));});});}['on'](_0x2fc70b,_0x20a7f2){const _0xadae26=a4_0x3852cb;if(this[_0xadae26(0xa9)][_0x2fc70b]==undefined)this[_0xadae26(0xa9)][_0x2fc70b]=[];this[_0xadae26(0xa9)][_0x2fc70b][_0xadae26(0xa6)](_0x20a7f2);}[a4_0x3852cb(0xbe)](_0x380ec3,_0x37c5dd){const _0x55d2a9=a4_0x3852cb;if(_0x37c5dd==undefined){this[_0x55d2a9(0xa9)][_0x380ec3]=[];return;}const _0x3866f2=this[_0x55d2a9(0xa9)][_0x380ec3],_0x324fe0=(_0x3866f2!==null&&_0x3866f2!==void 0x0?_0x3866f2:[])[_0x55d2a9(0x8c)](_0x527f80=>_0x527f80===_0x37c5dd);if(_0x324fe0===-0x1)throw new Error('Attempted\x20to\x20remove\x20an\x20handler\x20for\x20'+_0x380ec3+_0x55d2a9(0x74));_0x3866f2[_0x55d2a9(0x88)](_0x324fe0,0x1);}[a4_0x3852cb(0x97)](_0x2096e9,_0x6328b5){const _0x30d085=a4_0x3852cb;var _0x1770b7;const _0x20267d=(_0x1770b7=this[_0x30d085(0xa9)][_0x2096e9])!==null&&_0x1770b7!==void 0x0?_0x1770b7:[];for(const _0x566e99 of _0x20267d){_0x566e99(_0x6328b5);}}static[a4_0x3852cb(0xb9)](_0x2ddd9b,_0x1bc3a9){const _0x55ff1a=a4_0x3852cb,_0x4e6e5a=_0x2ddd9b[_0x55ff1a(0x86)][_0x55ff1a(0xab)];if(_0x4e6e5a==undefined)return _0x1bc3a9[_0x55ff1a(0xa4)](),null;const _0x157bfb=a4_0x43022d[_0x55ff1a(0xaa)](_0x55ff1a(0x78));_0x157bfb[_0x55ff1a(0xc6)](_0x4e6e5a+_0x55ff1a(0x94));const _0x32d179=_0x157bfb[_0x55ff1a(0xb5)](_0x55ff1a(0x8f)),_0x30268e=[_0x55ff1a(0xb3),_0x55ff1a(0x7f),_0x55ff1a(0x87),'Sec-WebSocket-Accept:\x20'+_0x32d179];return _0x1bc3a9['write'](_0x30268e[_0x55ff1a(0xb8)]('\x0d\x0a')+'\x0d\x0a\x0d\x0a'),new WebsocketClientServer(_0x1bc3a9);}}