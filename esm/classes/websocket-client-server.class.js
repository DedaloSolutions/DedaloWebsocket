function a4_0x43fc(_0x3edb2b,_0x5c4a1){const _0x4e7734=a4_0x4e77();return a4_0x43fc=function(_0x43fc49,_0x2b2423){_0x43fc49=_0x43fc49-0xb3;let _0x3e0135=_0x4e7734[_0x43fc49];return _0x3e0135;},a4_0x43fc(_0x3edb2b,_0x5c4a1);}function a4_0x4e77(){const _0x466b1e=['\x20event\x20type\x20but\x20it\x20wasn\x27t\x20found','Upgrade:\x20websocket','Attempted\x20to\x20remove\x20an\x20handler\x20for\x20','apply','utf-8','length','splice','HTTP/1.1\x20101\x20Switching\x20Protocols','createHash','writeUInt16BE','48jSGRpw','findIndex','open','socket','4981179rCEVZU','concat','toString','value','Received\x20a\x20request\x20with\x20callback\x20for\x20the\x20event\x20','handlers','5128RguVGQ','join','sec-websocket-key','handshake','base64','readBigUInt64BE','update','next','digest','binary','close','requestId','Received\x20a\x20request\x20with\x20eventName\x20','328355wfGXTh','\x20but\x20no\x20pending\x20request\x20was\x20found','pendingRequests',';\x20This\x20is\x20non-standard:\x20someone\x20is\x20trying\x20to\x20hack\x20the\x20protocol?','destroy','The\x20websocket\x20is\x20not\x20connected','error','3682420HXRUaa','Received\x20a\x20response\x20for\x20the\x20id\x20','push','disconnect','258EAFA5-E914-47DA-95CA-C5AB0DC85B11','from','includes','end','Received\x20non-standard\x20text\x20message:\x20','checkHeartbeat','Received\x20message\x20with\x20unsupported\x20opcode:\x20','sha1','pong','pingRequests','735747PXIUHn','off','handle','encode','slice','alloc','decode','closing','text','fromUpgradeRequest','call','2JnJQEF','pingTimeout','closed','Timeout','\x20but\x20no\x20handler\x20return\x20a\x20result','headers','send','done','once','843863REdyNY','32840760ttmGyT','then','status','pingInterval','ping','randomUUID','readUInt16BE','write','readUInt8','13014XBeIXx','data','raise'];a4_0x4e77=function(){return _0x466b1e;};return a4_0x4e77();}const a4_0x25b0e9=a4_0x43fc;(function(_0x14b120,_0x4dd6a7){const _0x217c6a=a4_0x43fc,_0x499bd8=_0x14b120();while(!![]){try{const _0x439128=-parseInt(_0x217c6a(0xc9))/0x1+parseInt(_0x217c6a(0xc0))/0x2*(-parseInt(_0x217c6a(0xb5))/0x3)+-parseInt(_0x217c6a(0xfe))/0x4+parseInt(_0x217c6a(0xf7))/0x5*(-parseInt(_0x217c6a(0xe0))/0x6)+parseInt(_0x217c6a(0xe4))/0x7+-parseInt(_0x217c6a(0xea))/0x8*(parseInt(_0x217c6a(0xd3))/0x9)+parseInt(_0x217c6a(0xca))/0xa;if(_0x439128===_0x4dd6a7)break;else _0x499bd8['push'](_0x499bd8['shift']());}catch(_0x54725a){_0x499bd8['push'](_0x499bd8['shift']());}}}(a4_0x4e77,0x824c6));var __awaiter=this&&this['__awaiter']||function(_0x46ae92,_0x1ff1c6,_0x166bbc,_0x236f62){function _0x50eca8(_0x5cf621){return _0x5cf621 instanceof _0x166bbc?_0x5cf621:new _0x166bbc(function(_0x31c39c){_0x31c39c(_0x5cf621);});}return new(_0x166bbc||(_0x166bbc=Promise))(function(_0x2dcc0a,_0x3c77ed){const _0x11ca06=a4_0x43fc;function _0x51fa35(_0x1963c8){const _0x4b7986=a4_0x43fc;try{_0x3e977d(_0x236f62[_0x4b7986(0xf1)](_0x1963c8));}catch(_0x387fd7){_0x3c77ed(_0x387fd7);}}function _0x2543d0(_0x5ba576){try{_0x3e977d(_0x236f62['throw'](_0x5ba576));}catch(_0x1429cf){_0x3c77ed(_0x1429cf);}}function _0x3e977d(_0x11c685){const _0x514bf9=a4_0x43fc;_0x11c685[_0x514bf9(0xc7)]?_0x2dcc0a(_0x11c685['value']):_0x50eca8(_0x11c685[_0x514bf9(0xe7)])[_0x514bf9(0xcb)](_0x51fa35,_0x2543d0);}_0x3e977d((_0x236f62=_0x236f62[_0x11ca06(0xd9)](_0x46ae92,_0x1ff1c6||[]))[_0x11ca06(0xf1)]());});};import a4_0x44cf0d from'crypto';export default class WebsocketClientServer{constructor(_0x2b223c){const _0x5910c5=a4_0x43fc;this[_0x5910c5(0xe3)]=_0x2b223c,this['status']=_0x5910c5(0xed),this[_0x5910c5(0xcd)]=0x5*0x3e8,this[_0x5910c5(0xc1)]=0x2*0x3e8,this[_0x5910c5(0xb4)]={},this[_0x5910c5(0xf5)]=0x1,this[_0x5910c5(0xf9)]={},this[_0x5910c5(0xe9)]={},this[_0x5910c5(0xe3)]['on']('data',_0x48c073=>this[_0x5910c5(0xb7)](_0x48c073)),this[_0x5910c5(0xe3)]['on']('error',_0x39847f=>this[_0x5910c5(0xd5)](_0x5910c5(0xfd),_0x39847f)),this['socket']['on'](_0x5910c5(0xf4),()=>{}),this[_0x5910c5(0x107)]();const _0x33ce5a=this['encode']({'pingInterval':this['pingInterval']});this['send'](_0x5910c5(0xf3),_0x33ce5a);}[a4_0x25b0e9(0x101)](){return __awaiter(this,arguments,void 0x0,function*(_0x1b36a5=0x3e8,_0x153251='',_0x7c24ae=0x1388){return new Promise((_0xd8cca7,_0x205fb5)=>{const _0x507f95=a4_0x43fc,_0x3c58d0=Buffer[_0x507f95(0x103)](_0x153251,_0x507f95(0xda)),_0x3154f3=Buffer['alloc'](0x2+_0x3c58d0[_0x507f95(0xdb)]);_0x3154f3[_0x507f95(0xdf)](_0x1b36a5,0x0),_0x3c58d0['copy'](_0x3154f3,0x2);const _0x388ae4=_0x3154f3['length'],_0x2a3522=_0x388ae4<0x7e?_0x388ae4:_0x388ae4<0x10000?0x7e:0x7f,_0x16b524=_0x2a3522===0x7e?Buffer['from']([0x88,0x7e,_0x388ae4>>0x8&0xff,_0x388ae4&0xff]):_0x2a3522===0x7f?Buffer['from']([0x88,0x7f,0x0,0x0,0x0,0x0,0x0,0x0,_0x388ae4>>0x8&0xff,_0x388ae4&0xff]):Buffer[_0x507f95(0x103)]([0x88,_0x388ae4]),_0x306edd=Buffer[_0x507f95(0xe5)]([_0x16b524,_0x3154f3]);this['socket'][_0x507f95(0xd1)](_0x306edd),this['status']=_0x507f95(0xbc);if(_0x7c24ae===null)this['status']=_0x507f95(0xc2),this[_0x507f95(0xe3)][_0x507f95(0x105)](),this[_0x507f95(0xd5)](_0x507f95(0xf4),{'code':_0x1b36a5,'reason':_0x153251}),_0xd8cca7();else{let _0x4d4d1a=!![];this[_0x507f95(0xe3)][_0x507f95(0xc8)](_0x507f95(0xd4),_0x5a97f2=>{const _0x40a80a=_0x507f95;if(!_0x4d4d1a)return;_0x5a97f2[0x0]===0x88?(this['status']=_0x40a80a(0xc2),this[_0x40a80a(0xe3)]['end'](),this[_0x40a80a(0xd5)](_0x40a80a(0xf4),{'code':_0x1b36a5,'reason':_0x153251}),_0xd8cca7()):_0x205fb5(new Error('Failed\x20to\x20receive\x20valid\x20close\x20frame\x20from\x20server.'));}),setTimeout(()=>{const _0x4d4187=_0x507f95;_0x4d4d1a=![],_0x205fb5(new Error('Timeout\x20waiting\x20for\x20close\x20frame\x20acknowledgment.')),this[_0x4d4187(0xe3)]['end']();},_0x7c24ae);}});});}['send'](_0x5a91fe,_0x706709){const _0x53880c=a4_0x25b0e9;let _0x4e4beb,_0x892d63;switch(_0x5a91fe){case _0x53880c(0xbd):_0x4e4beb=Buffer[_0x53880c(0x103)](_0x706709,_0x53880c(0xda)),_0x892d63=0x1;break;case _0x53880c(0xf3):_0x4e4beb=_0x706709,_0x892d63=0x2;break;case'ping':_0x4e4beb=_0x706709,_0x892d63=0x9;break;case _0x53880c(0xb3):_0x4e4beb=_0x706709,_0x892d63=0xa;break;}const _0x333a70=[];if(_0x4e4beb[_0x53880c(0xdb)]<0x7e)_0x333a70[_0x53880c(0x100)](_0x4e4beb[_0x53880c(0xdb)]);else{if(_0x4e4beb[_0x53880c(0xdb)]<0x10000)_0x333a70[_0x53880c(0x100)](0x7e,_0x4e4beb['length']>>0x8&0xff,_0x4e4beb['length']&0xff);else{_0x333a70[_0x53880c(0x100)](0x7f);for(let _0x5b223f=0x7;_0x5b223f>=0x0;_0x5b223f--)_0x333a70[_0x53880c(0x100)](_0x4e4beb['length']>>_0x5b223f*0x8&0xff);}}const _0xce89e0=Buffer[_0x53880c(0xe5)]([Buffer[_0x53880c(0x103)]([0x80|_0x892d63,..._0x333a70]),_0x4e4beb]);this['socket'][_0x53880c(0xd1)](_0xce89e0);}['emit'](_0x1ac2f7,_0x1927d0,_0x381945,_0x479e00=0x32*0x3e8){const _0x856822=a4_0x25b0e9;if(this['socket']==undefined||this[_0x856822(0xcc)]!==_0x856822(0xe2))throw new Error(_0x856822(0xfc));if([_0x856822(0xed),'open',_0x856822(0xfd),'close'][_0x856822(0x104)](_0x1ac2f7))throw new Error('Cannot\x20emit\x20a\x20class\x20internal\x20event\x20as\x20handskake,\x20open,\x20error\x20or\x20close');const _0x139ad8=_0x381945==undefined?0x0:this['requestId'],_0x3fa486=Buffer[_0x856822(0x103)](_0x1ac2f7,_0x856822(0xda));if(_0x3fa486['length']>0xff)throw new Error('Event\x20name\x20too\x20long\x20(max\x20255\x20bytes)');if(_0x381945!=undefined){this[_0x856822(0xf5)]=(this[_0x856822(0xf5)]+0x1)%0x80||0x1;const _0x59f915=setTimeout(()=>{const _0x483494=_0x856822;delete this[_0x483494(0xf9)][_0x139ad8],_0x381945(new Error(_0x483494(0xc3)));},_0x479e00);this[_0x856822(0xf9)][_0x139ad8]=_0x1440bd=>{if(!(_0x1440bd instanceof Error))clearTimeout(_0x59f915);_0x381945(_0x1440bd);};}const _0x171357=Buffer[_0x856822(0xe5)]([Buffer['from']([_0x139ad8|0x80,_0x3fa486[_0x856822(0xdb)]]),_0x3fa486,this[_0x856822(0xb8)](_0x1927d0)]);this[_0x856822(0xc6)](_0x856822(0xf3),_0x171357);}[a4_0x25b0e9(0xb7)](_0x283a05){const _0x1de4bd=a4_0x25b0e9;var _0x316efa;const _0x296cef=_0x283a05[0x0],_0x106852=(_0x296cef&0x80)!==0x0,_0x25bf9b=_0x296cef&0xf,_0x13e8fd=_0x283a05[0x1],_0x45bd01=(_0x13e8fd&0x80)!==0x0;let _0x5eb125=_0x13e8fd&0x7f,_0x55f320=0x2;if(_0x5eb125===0x7e)_0x5eb125=_0x283a05[_0x1de4bd(0xd0)](_0x55f320),_0x55f320+=0x2;else _0x5eb125===0x7f&&(_0x5eb125=Number(_0x283a05[_0x1de4bd(0xef)](_0x55f320)),_0x55f320+=0x8);const _0x574452=_0x45bd01?_0x283a05[_0x1de4bd(0xb9)](_0x55f320,_0x55f320+0x4):Buffer['alloc'](0x0);if(_0x45bd01)_0x55f320+=0x4;let _0x2da95c=_0x283a05['slice'](_0x55f320,_0x55f320+_0x5eb125);if(_0x45bd01){const _0x27cd65=Buffer['alloc'](_0x2da95c[_0x1de4bd(0xdb)]);for(let _0x5ef019=0x0;_0x5ef019<_0x2da95c[_0x1de4bd(0xdb)];_0x5ef019++)_0x27cd65[_0x5ef019]=_0x2da95c[_0x5ef019]^_0x574452[_0x5ef019%0x4];_0x2da95c=_0x27cd65;}switch(_0x25bf9b){case 0x1:this[_0x1de4bd(0xd5)](_0x1de4bd(0xfd),new Error(_0x1de4bd(0x106)+_0x2da95c['toString']('utf-8')));break;case 0x2:{if(this['status']===_0x1de4bd(0xed)){const _0x3f2d38=this[_0x1de4bd(0xbb)](_0x2da95c);for(const _0x5c42e2 of this[_0x1de4bd(0xe9)][_0x1de4bd(0xed)]||[]){const _0x182731=_0x5c42e2[_0x1de4bd(0xbf)](undefined,_0x3f2d38);if(_0x182731===![]){this[_0x1de4bd(0x101)](0x3e8,'',null);return;}}this['status']='open',this['send'](_0x1de4bd(0xf3),Buffer[_0x1de4bd(0xba)](0x0));return;}const _0x2d2598=_0x2da95c[_0x1de4bd(0xd2)](0x0),_0x340e30=_0x2d2598&0x7f,_0x4199ab=(_0x2d2598&0x80)!==0x0;if(_0x4199ab){const _0x5bc5ad=_0x2da95c[_0x1de4bd(0xd2)](0x1),_0x2a255e=_0x2da95c[_0x1de4bd(0xb9)](0x2,0x2+_0x5bc5ad)[_0x1de4bd(0xe6)]('utf-8');if([_0x1de4bd(0xed),'open',_0x1de4bd(0xfd),_0x1de4bd(0xf4)][_0x1de4bd(0x104)](_0x2a255e)){this[_0x1de4bd(0xd5)]('error',new Error(_0x1de4bd(0xf6)+_0x2a255e+_0x1de4bd(0xfa)));return;}const _0x1f37d1=this['decode'](_0x2da95c[_0x1de4bd(0xb9)](0x2+_0x5bc5ad)),_0x54d89c=(_0x316efa=this[_0x1de4bd(0xe9)][_0x2a255e])!==null&&_0x316efa!==void 0x0?_0x316efa:[];let _0x277edd=![];for(const _0xb64fc of _0x54d89c){const _0x39801b=_0xb64fc[_0x1de4bd(0xbf)](undefined,_0x1f37d1);if(!_0x277edd&&_0x39801b!==undefined&&_0x340e30!==0x0){_0x277edd=!![];const _0x707f2b=Buffer[_0x1de4bd(0xe5)]([Buffer['from']([_0x340e30&0x7f]),this['encode'](_0x39801b)]);this[_0x1de4bd(0xc6)](_0x1de4bd(0xf3),_0x707f2b);}}if(!_0x277edd&&_0x340e30!==0x0)this[_0x1de4bd(0xd5)]('error',new Error(_0x1de4bd(0xe8)+_0x2a255e+_0x1de4bd(0xc4)));return;}const _0x3965bb=this[_0x1de4bd(0xf9)][_0x340e30];if(_0x3965bb==undefined){this['raise'](_0x1de4bd(0xfd),new Error(_0x1de4bd(0xff)+_0x340e30+_0x1de4bd(0xf8)));return;}const _0x3e8456=this[_0x1de4bd(0xbb)](_0x2da95c[_0x1de4bd(0xb9)](0x1));_0x3965bb['call'](undefined,_0x3e8456);break;}case 0x9:this[_0x1de4bd(0xc6)](_0x1de4bd(0xb3),_0x2da95c);break;case 0xa:const _0x4b8fea=_0x2da95c[_0x1de4bd(0xe6)](_0x1de4bd(0xda)),_0x6e8a1e=this[_0x1de4bd(0xb4)][_0x4b8fea];if(_0x6e8a1e==undefined){this[_0x1de4bd(0xd5)](_0x1de4bd(0xfd),new Error('Received\x20a\x20pong,\x20but\x20it\x20doesn\x27t\x20match\x20any\x20ping'));return;}_0x6e8a1e();break;case 0x8:if(this[_0x1de4bd(0xcc)]===_0x1de4bd(0xbc))return;let _0x34e3b3=0x3e8,_0x51eea4='';_0x2da95c[_0x1de4bd(0xdb)]>=0x2&&(_0x34e3b3=_0x2da95c['readUInt16BE'](0x0),_0x51eea4=_0x2da95c['slice'](0x2)[_0x1de4bd(0xe6)]('utf-8'));this['disconnect'](_0x34e3b3,_0x51eea4,null);break;default:this[_0x1de4bd(0xd5)](_0x1de4bd(0xfd),new Error(_0x1de4bd(0x108)+_0x25bf9b));}}[a4_0x25b0e9(0xb8)](_0x3ce088){const _0x244cc9=a4_0x25b0e9;return Buffer[_0x244cc9(0x103)](JSON['stringify'](_0x3ce088),_0x244cc9(0xda));}[a4_0x25b0e9(0xbb)](_0x12d13f){const _0x9b8429=a4_0x25b0e9;return JSON['parse'](_0x12d13f[_0x9b8429(0xe6)](_0x9b8429(0xda)));}[a4_0x25b0e9(0x107)](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise((_0x49f5e9,_0x321e4a)=>{const _0x354efc=a4_0x43fc,_0xb963fe=a4_0x44cf0d[_0x354efc(0xcf)](),_0x2ef1a3=setTimeout(()=>{const _0x53e577=_0x354efc;delete this[_0x53e577(0xb4)][_0xb963fe],this[_0x53e577(0x101)](0x3e8,'',null),_0x49f5e9(![]);},this[_0x354efc(0xc1)]);this[_0x354efc(0xb4)][_0xb963fe]=()=>{const _0x31bacb=_0x354efc;delete this[_0x31bacb(0xb4)][_0xb963fe],clearTimeout(_0x2ef1a3),_0x49f5e9(!![]),setTimeout(()=>{const _0x82fc21=_0x31bacb;if(this['status']!==_0x82fc21(0xe2))return;this['checkHeartbeat']();},this[_0x31bacb(0xcd)]);},this[_0x354efc(0xc6)](_0x354efc(0xce),Buffer[_0x354efc(0x103)](_0xb963fe));});});}['on'](_0x51e761,_0x44a9ea){const _0x15e3ed=a4_0x25b0e9;if(this[_0x15e3ed(0xe9)][_0x51e761]==undefined)this[_0x15e3ed(0xe9)][_0x51e761]=[];this['handlers'][_0x51e761][_0x15e3ed(0x100)](_0x44a9ea);}[a4_0x25b0e9(0xb6)](_0x357380,_0x1dc2d2){const _0x1418b0=a4_0x25b0e9;if(_0x1dc2d2==undefined){this[_0x1418b0(0xe9)][_0x357380]=[];return;}const _0x47deee=this['handlers'][_0x357380],_0x3bb237=(_0x47deee!==null&&_0x47deee!==void 0x0?_0x47deee:[])[_0x1418b0(0xe1)](_0x105683=>_0x105683===_0x1dc2d2);if(_0x3bb237===-0x1)throw new Error(_0x1418b0(0xd8)+_0x357380+_0x1418b0(0xd6));_0x47deee[_0x1418b0(0xdc)](_0x3bb237,0x1);}[a4_0x25b0e9(0xd5)](_0x4a4d8f,_0x49432d){const _0x228a0b=a4_0x25b0e9;var _0x4136ed;const _0x3d0921=(_0x4136ed=this[_0x228a0b(0xe9)][_0x4a4d8f])!==null&&_0x4136ed!==void 0x0?_0x4136ed:[];for(const _0x986077 of _0x3d0921){_0x986077(_0x49432d);}}static[a4_0x25b0e9(0xbe)](_0x15c1a6,_0x1f3001){const _0x50943c=a4_0x25b0e9,_0xe74da=_0x15c1a6[_0x50943c(0xc5)][_0x50943c(0xec)];if(_0xe74da==undefined)return _0x1f3001[_0x50943c(0xfb)](),null;const _0xf538f4=a4_0x44cf0d[_0x50943c(0xde)](_0x50943c(0x109));_0xf538f4[_0x50943c(0xf0)](_0xe74da+_0x50943c(0x102));const _0x194ccc=_0xf538f4[_0x50943c(0xf2)](_0x50943c(0xee)),_0xcbd02e=[_0x50943c(0xdd),_0x50943c(0xd7),'Connection:\x20Upgrade','Sec-WebSocket-Accept:\x20'+_0x194ccc];return _0x1f3001['write'](_0xcbd02e[_0x50943c(0xeb)]('\x0d\x0a')+'\x0d\x0a\x0d\x0a'),new WebsocketClientServer(_0x1f3001);}}